

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Chương 6: Ánh xạ chéo hội tụ (Convergent Cross Mapping) &#8212; Bản dịch Time Series Analysis Handbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '06_ConvergentCrossMappingandSugiharaCausality/ccm_sugihara';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../Preface/Preface.html">
  
  
  
  
  
  
    <p class="title logo__title">Bản dịch Time Series Analysis Handbook</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../Preface/Preface.html">
                    Lời nói đầu: Giới thiệu về Phân tích Chuỗi Thời Gian (Time Series Analysis)
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../01_AutoRegressiveIntegratedMovingAverage/01_AutoRegressiveIntegratedMovingAverage.html">Chương 1: Trung bình trượt tích hợp tự hồi quy (ARIMA)</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/06_ConvergentCrossMappingandSugiharaCausality/ccm_sugihara.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Chương 6: Ánh xạ chéo hội tụ (Convergent Cross Mapping)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gioi-thieu">Giới thiệu</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#goi-causal-ccm">Gói causal-ccm</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tam-quan-trong-cua-viec-hieu-nhan-qua">Tầm quan trọng của việc hiểu Nhân quả</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#han-che-cua-nhan-qua-granger">Hạn chế của Nhân quả Granger</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ccm-giai-quyet-cac-han-che-cua-nhan-qua-granger">CCM giải quyết các hạn chế của Nhân quả Granger</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cac-khai-niem-lien-quan">Các khái niệm liên quan</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#he-dong-luc-xac-dinh-deterministic-dynamical-systems">Hệ động lực xác định (Deterministic Dynamical Systems)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bo-hut-attractors">Bộ hút (Attractors)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dinh-ly-nhung-takens-va-cac-da-tap-bong-shadow-manifolds">Định lý nhúng Takens và các đa tạp bóng (Shadow Manifolds)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tong-quan-ve-ccm">Tổng quan về CCM</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cross-mapping-anh-xa-cheo">Cross Mapping (Ánh xạ chéo)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hoi-tu-convergence">Hội tụ (Convergence)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#xac-dinh-he-thong-mau-cua-chung-ta">Xác định hệ thống mẫu của chúng ta</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ccm-algorithm">CCM Algorithm</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dinh-nghia-cac-ham-trong-ccm">Định nghĩa các hàm trong CCM</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cac-ham-dung-de-truc-quan-hoa">Các hàm dùng để trực quan hóa</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#applying-ccm-to-our-sample-systems">Applying CCM to our Sample Systems</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ccm-co-the-du-doan-quan-he-nhan-qua-trong-he-kiem-thu-cua-chung-ta-khong">CCM có thể dự đoán quan hệ nhân quả trong hệ kiểm thử của chúng ta không?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cach-cac-he-so-beta-anh-huong-den-quan-he-nhan-qua-duoc-the-hien-thong-qua-su-hoi-tu">Cách các hệ số Beta ảnh hưởng đến quan hệ nhân quả được thể hiện thông qua sự hội tụ</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dieu-gi-xay-ra-neu-he-duoc-ghep-noi-bat-doi-xung-tac-dong-chi-theo-mot-chieu">Điều gì xảy ra nếu hệ được ghép nối bất đối xứng (tác động chỉ theo một chiều)?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#anh-huong-cua-strong-forcing-tac-dong-cuong-buc-manh">Ảnh hưởng của “Strong Forcing” (tác động cưỡng bức mạnh)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ung-dung-trong-cac-he-thong-thuc-te">Ứng dụng trong các hệ thống thực tế</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phim-cua-nicolas-cage-va-so-nguoi-chet-duoi-tai-my">Phim của Nicolas Cage và số người chết đuối tại Mỹ</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#he-thong-dap">Hệ thống đập</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dap-angat-vs-luong-mua">Đập Angat vs Lượng mưa</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Đập Angat vs Lượng mưa</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dap-ipo-vs-luong-mua">Đập Ipo vs Lượng mưa</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dap-ipo-vs-nia">Đập Ipo vs NIA</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dap-ipo-vs-dap-angat">Đập Ipo vs Đập Angat</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cac-moi-quan-he-nhan-qua-duoc-suy-ra-trong-he-thong-dap">Các mối quan hệ nhân quả được suy ra trong hệ thống đập</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#du-lieu-khi-hau-jena">Dữ liệu khí hậu Jena</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bien-doi-khi-hau">Biến đổi khí hậu</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phat-thai-co2-nhiet-do-toan-cau-va-dien-tich-bang-bac-cuc-phi-sinh-thai-non-ecological">Phát thải CO₂, nhiệt độ toàn cầu và diện tích băng Bắc Cực (phi sinh thái / non-ecological)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cac-moi-quan-he-nhan-qua-cua-he-thong-khi-hau-duoc-suy-luan">Các mối quan hệ nhân quả của hệ thống khí hậu được suy luận</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#han-che">Hạn chế</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tom-tat">Tóm tắt</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tai-lieu-tham-khao">Tài liệu tham khảo</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chuong-6-anh-xa-cheo-hoi-tu-convergent-cross-mapping">
<h1>Chương 6: Ánh xạ chéo hội tụ (Convergent Cross Mapping)<a class="headerlink" href="#chuong-6-anh-xa-cheo-hoi-tu-convergent-cross-mapping" title="Permalink to this heading">#</a></h1>
<p>Biên soạn bởi: Prince Joseph Erneszer Javier</p>
<section id="gioi-thieu">
<h2>Giới thiệu<a class="headerlink" href="#gioi-thieu" title="Permalink to this heading">#</a></h2>
<p>Trong các chương trước, chúng ta đã nói về Simplex Projection, một kỹ thuật dự báo tìm kiếm các xu hướng tương tự trong quá khứ để dự báo tương lai bằng cách tính toán các láng giềng gần nhất trong một embedding. Trong chương này, chúng ta thảo luận về Convergent Cross Mapping (CCM), cũng được đề xuất bởi <a class="reference external" href="https://science.sciencemag.org/content/338/6106/496">Sugihara et al., 2012</a> như một phương pháp sử dụng các ý tưởng từ Simplex Projection để xác định quan hệ nhân quả giữa các biến trong một hệ động lực phức tạp (ví dụ: hệ sinh thái) chỉ bằng dữ liệu chuỗi thời gian.</p>
<p>Chúng ta sẽ lần lượt đi qua các ý tưởng cốt lõi của CCM, cách phương pháp này giải quyết các hạn chế của nhân quả Granger, và thuật toán đứng sau nó. Sau đó, chúng ta sẽ kiểm nghiệm khuôn khổ CCM trên dữ liệu mô phỏng, trong đó chúng ta cố ý điều chỉnh mức độ ảnh hưởng của một biến lên biến còn lại. Cuối cùng, chúng ta sẽ áp dụng CCM lên một số dữ liệu thực tế để suy luận các mối quan hệ giữa các biến trong một hệ thống.</p>
<section id="goi-causal-ccm">
<h3>Gói causal-ccm<a class="headerlink" href="#goi-causal-ccm" title="Permalink to this heading">#</a></h3>
<p>Chương này giải thích chi tiết phương pháp CCM. Nếu bạn muốn áp dụng phương pháp này trong các dự án của riêng mình, hãy cài đặt framework bằng lệnh <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">causal-ccm</span></code>. Xem notebook <code class="docutils literal notranslate"><span class="pre">using_causal_ccm_package.ipynb</span></code> để biết chi tiết cách sử dụng.</p>
</section>
<section id="tam-quan-trong-cua-viec-hieu-nhan-qua">
<h3>Tầm quan trọng của việc hiểu Nhân quả<a class="headerlink" href="#tam-quan-trong-cua-viec-hieu-nhan-qua" title="Permalink to this heading">#</a></h3>
<p>Chúng ta định nghĩa nhân quả là sự ảnh hưởng của một biến lên một biến khác. Việc hiểu nhân quả là quan trọng vì nó cho phép chúng ta:</p>
<ul class="simple">
<li><p>Giải thích các hiện tượng mà không nhất thiết là siêu nhiên / huyền bí</p></li>
<li><p>Dự đoán tương lai và đưa ra các điều chỉnh cần thiết</p></li>
<li><p>Áp dụng các can thiệp vào hệ thống để đạt được các kết quả mong muốn</p></li>
</ul>
</section>
<section id="han-che-cua-nhan-qua-granger">
<h3>Hạn chế của Nhân quả Granger<a class="headerlink" href="#han-che-cua-nhan-qua-granger" title="Permalink to this heading">#</a></h3>
<p>Trong Chương 4, chúng ta đã thảo luận về một khuôn khổ để thiết lập nhân quả trong một hệ thống, được gọi là Nhân quả Granger. Tuy nhiên, Nhân quả Granger có những hạn chế nhất định.</p>
<p>Trực giác đằng sau Nhân quả Granger là: một biến A gây ra B nếu chúng ta có một mô hình giúp cải thiện việc dự báo B khi chúng ta đưa A vào. Khuôn khổ này giả định rằng chúng ta có thể “tách” thông tin về A ra khỏi phần còn lại của hệ thống. Tuy nhiên, trong nhiều hệ thống có các thành phần tương tác với nhau, thông tin về một biến không nhất thiết có thể được loại bỏ khỏi phần còn lại của hệ thống. Chúng được tích hợp với nhau, hay nói cách khác, không thể tách rời.</p>
<p>Khuôn khổ Nhân quả Granger không áp dụng được cho các trường hợp mà thông tin về các biến không thể tách rời khỏi phần còn lại của hệ thống, đặc biệt đối với những hệ có mối quan hệ nhân quả yếu đến trung bình (như trong các hệ thống thử nghiệm của chúng ta ở các phần tiếp theo). Cuối cùng, Nhân quả Granger phụ thuộc vào hiệu năng của một mô hình dự báo tuyến tính, vốn giả định sự kết hợp tuyến tính của các biến. Mô hình này có thể không hoạt động tốt đối với một số hệ thống cần các mô hình phi tuyến để cải thiện khả năng dự báo.</p>
</section>
<section id="ccm-giai-quyet-cac-han-che-cua-nhan-qua-granger">
<h3>CCM giải quyết các hạn chế của Nhân quả Granger<a class="headerlink" href="#ccm-giai-quyet-cac-han-che-cua-nhan-qua-granger" title="Permalink to this heading">#</a></h3>
<p>Convergent Cross Mapping (CCM) được thiết kế để xác định và định lượng quan hệ nhân quả trong các hệ mà các biến không thể tách rời. Ngoài ra, CCM còn được thiết kế để xác định và định lượng các mối quan hệ nhân quả yếu đến trung bình, những mối quan hệ mà Nhân quả Granger có thể bỏ sót. Cuối cùng, CCM không phụ thuộc vào một mô hình dự báo cụ thể, vì vậy chúng ta không bị lệ thuộc vào hiệu năng của mô hình.</p>
</section>
</section>
<section id="cac-khai-niem-lien-quan">
<h2>Các khái niệm liên quan<a class="headerlink" href="#cac-khai-niem-lien-quan" title="Permalink to this heading">#</a></h2>
<p>Chúng ta sẽ thảo luận ngắn gọn các khái niệm then chốt liên quan đến CCM. Nhiều khái niệm trong số này đã được trình bày chi tiết trong chương trước: Các phương pháp dự báo động lực học.</p>
<section id="he-dong-luc-xac-dinh-deterministic-dynamical-systems">
<h3>Hệ động lực xác định (Deterministic Dynamical Systems)<a class="headerlink" href="#he-dong-luc-xac-dinh-deterministic-dynamical-systems" title="Permalink to this heading">#</a></h3>
<p>“Xác định” (deterministic) nghĩa là không có tính ngẫu nhiên trong hệ (ngay cả khi hệ trông có vẻ ngẫu nhiên, ví dụ như hỗn loạn). “Động lực” (dynamical) nghĩa là các giá trị hay “trạng thái” của hệ thay đổi theo thời gian. “Hệ” (system) nghĩa là đó là một tập hợp các thành phần tương tác với nhau.</p>
</section>
<section id="bo-hut-attractors">
<h3>Bộ hút (Attractors)<a class="headerlink" href="#bo-hut-attractors" title="Permalink to this heading">#</a></h3>
<img alt="https://fromsystosys.netlify.com/img/lorenz_custom_pers_small.gif" src="https://fromsystosys.netlify.com/img/lorenz_custom_pers_small.gif" />
<p>Một bộ hút là một “không gian” các trạng thái mà hệ có xu hướng bị hút về khi thời gian trôi đi. Khi các bộ hút có thể được xem như những không gian cong, chúng được gọi là đa tạp (manifolds). Chúng ta có thể hình dung bộ hút như một cách để tóm tắt hệ thống, tương tự như một tầng embedding trong kiến trúc mạng nơ-ron.</p>
<p><em>Câu hỏi: Theo bạn, loại bộ hút đơn giản nhất là gì?</em></p>
</section>
<section id="dinh-ly-nhung-takens-va-cac-da-tap-bong-shadow-manifolds">
<h3>Định lý nhúng Takens và các đa tạp bóng (Shadow Manifolds)<a class="headerlink" href="#dinh-ly-nhung-takens-va-cac-da-tap-bong-shadow-manifolds" title="Permalink to this heading">#</a></h3>
<a class="reference internal image-reference" href="https://www.researchgate.net/profile/Pablo_Verdes/publication/51595532/figure/fig4/AS:305687352627206&#64;1449892952960/Color-online-Schematic-representation-of-the-measurement-process-and-reconstruction-of.png"><img alt="https://www.researchgate.net/profile/Pablo_Verdes/publication/51595532/figure/fig4/AS:305687352627206&#64;1449892952960/Color-online-Schematic-representation-of-the-measurement-process-and-reconstruction-of.png" src="https://www.researchgate.net/profile/Pablo_Verdes/publication/51595532/figure/fig4/AS:305687352627206&#64;1449892952960/Color-online-Schematic-representation-of-the-measurement-process-and-reconstruction-of.png" style="width: 500px;" /></a>
<p>Uzal, Lucas &amp; Grinblat, G &amp; Verdes, Pablo. (2011). Optimal reconstruction of dynamical systems: A noise amplification approach. Physical review. E, Statistical, nonlinear, and soft matter physics. 84. 016223. 10.1103/PhysRevE.84.016223.</p>
<p>Từ thuật ngữ “shadow”, đa tạp bóng là các “phép chiếu” của đa tạp hệ thực lên một biến nào đó X. Điều mà định lý Takens cho chúng ta biết là: nếu <span class="math notranslate nohighlight">\(X\)</span> thuộc về một hệ <span class="math notranslate nohighlight">\(S\)</span>, thì chúng ta có thể tạo ra một đa tạp bóng của đa tạp thực <span class="math notranslate nohighlight">\(M_s\)</span>, thì chúng ta có thể tạo ra một đa tạp bóng của đa tạp thực <span class="math notranslate nohighlight">\(X\)</span>. Các điểm trong đa tạp bóng này <span class="math notranslate nohighlight">\(M_x\)</span> sẽ có ánh xạ một–một với các điểm trong đa tạp thực (chưa biết) <span class="math notranslate nohighlight">\(M_s\)</span>.</p>
</section>
</section>
<section id="tong-quan-ve-ccm">
<h2>Tổng quan về CCM<a class="headerlink" href="#tong-quan-ve-ccm" title="Permalink to this heading">#</a></h2>
<a class="reference internal image-reference" href="https://media.springernature.com/lw785/springer-static/image/chp%3A10.1007%2F978-3-319-58895-7_27/MediaObjects/429072_1_En_27_Fig1_HTML.gif"><img alt="https://media.springernature.com/lw785/springer-static/image/chp%3A10.1007%2F978-3-319-58895-7_27/MediaObjects/429072_1_En_27_Fig1_HTML.gif" src="https://media.springernature.com/lw785/springer-static/image/chp%3A10.1007%2F978-3-319-58895-7_27/MediaObjects/429072_1_En_27_Fig1_HTML.gif" style="width: 400px;" /></a>
<p>Tsonis A.A., Deyle E.R., Ye H., Sugihara G. (2018) Convergent Cross Mapping: Theory and an Example. In: Tsonis A. (eds) Advances in Nonlinear Geosciences. Springer, Cham. https://doi.org/10.1007/978-3-319-58895-7_27</p>
<section id="cross-mapping-anh-xa-cheo">
<h3>Cross Mapping (Ánh xạ chéo)<a class="headerlink" href="#cross-mapping-anh-xa-cheo" title="Permalink to this heading">#</a></h3>
<p>Trong một hệ <span class="math notranslate nohighlight">\(Y=f(X,Y)\)</span>, cross Mapping có nghĩa là: với các điểm trên đa tạp của một biến <span class="math notranslate nohighlight">\(M_y\)</span>, ta tìm các điểm tương ứng trên <span class="math notranslate nohighlight">\(M_x\)</span>, tức là các điểm tại cùng thời điểm <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>Nếu <span class="math notranslate nohighlight">\(X\)</span> gây ra <span class="math notranslate nohighlight">\(Y\)</span>, thì ta nói rằng một phần thông tin của <span class="math notranslate nohighlight">\(X\)</span> được lưu trữ trong <span class="math notranslate nohighlight">\(Y\)</span>. Nếu điều này đúng, thì ta có thể dự đoán giá trị của <span class="math notranslate nohighlight">\(X\)</span> dựa trên các giá trị của <span class="math notranslate nohighlight">\(Y\)</span>. Lưu ý rằng điều này nghe có vẻ ngược trực giác. Điều này đối lập với nhân quả Granger, vốn cho rằng <span class="math notranslate nohighlight">\(X\)</span> gây ra <span class="math notranslate nohighlight">\(Y\)</span> nếu ta có thể dự đoán <span class="math notranslate nohighlight">\(Y\)</span> tốt hơn khi biết <span class="math notranslate nohighlight">\(X\)</span>.</p>
<p>Chúng ta sử dụng đa tạp bóng (shadow manifolds) vì ta không biết đa tạp thực của hệ. Tuy nhiên, theo định lý Takens, ta có thể khẳng định rằng ta có thể xây dựng các đa tạp bóng <span class="math notranslate nohighlight">\(M_x\)</span> và <span class="math notranslate nohighlight">\(M_y\)</span>, và các đa tạp này sẽ ánh xạ chéo với quan hệ một–một tới đa tạp thực của hệ.</p>
<p>Nếu dùng phép so sánh rằng các đa tạp là những “bản tóm tắt” của hệ thống, thì ta có thể xem <span class="math notranslate nohighlight">\(M_x\)</span> và <span class="math notranslate nohighlight">\(M_y\)</span> là các bản tóm tắt của <span class="math notranslate nohighlight">\(X\)</span> và <span class="math notranslate nohighlight">\(Y\)</span>. Nếu <span class="math notranslate nohighlight">\(X\)</span> gây ra <span class="math notranslate nohighlight">\(Y\)</span>, thông tin từ <span class="math notranslate nohighlight">\(X\)</span> sẽ được nhúng vào <span class="math notranslate nohighlight">\(Y\)</span>. Do đó, ta có thể sử dụng <span class="math notranslate nohighlight">\(M_x\)</span> để dự đoán <span class="math notranslate nohighlight">\(Y\)</span>, tức là <span class="math notranslate nohighlight">\(\hat{Y}|M_x\)</span>. Cuối cùng, ta sử dụng độ chính xác của phép dự đoán này (MAE, MSE hoặc hệ số tương quan) làm thước đo nhân quả.</p>
</section>
<section id="hoi-tu-convergence">
<h3>Hội tụ (Convergence)<a class="headerlink" href="#hoi-tu-convergence" title="Permalink to this heading">#</a></h3>
<p>Hội tụ trong CCM có nghĩa là: đối với các biến có quan hệ nhân quả, thời gian quan sát càng dài (hoặc dữ liệu càng nhiều), thì ta càng có thể dự đoán tốt hơn một biến bằng cách sử dụng biến còn lại.</p>
<p>Trong ví dụ về bộ hút ở trên, ta có thể hình dung rằng bộ hút sẽ trở nên dày đặc hơn theo thời gian, vì hệ thống cuối cùng sẽ lấp đầy các khoảng trống trong đa tạp. Nói cách khác, các đa tạp càng được xác định rõ thì, đối với các biến có quan hệ nhân quả, ta càng kỳ vọng độ chính xác của <span class="math notranslate nohighlight">\(\hat{Y}|M_x\)</span> sẽ được cải thiện. Nếu hai biến không có mối liên kết nhân quả, thì việc cải thiện chất lượng đa tạp của chúng sẽ không dẫn đến sự cải thiện trong dự đoán.</p>
<p>Cross mapping và convergence là hai điều kiện bắt buộc trong khuôn khổ CCM mà ta cần thỏa mãn để có thể xem xét khả năng tồn tại quan hệ nhân quả giữa các biến.</p>
</section>
</section>
<section id="xac-dinh-he-thong-mau-cua-chung-ta">
<h2>Xác định hệ thống mẫu của chúng ta<a class="headerlink" href="#xac-dinh-he-thong-mau-cua-chung-ta" title="Permalink to this heading">#</a></h2>
<p>Ở đây, chúng tôi trình bày một hệ phi tuyến mẫu. Trong hệ này, chúng tôi xác định rõ ràng rằng <span class="math notranslate nohighlight">\(X\)</span> chịu ảnh hưởng bởi <span class="math notranslate nohighlight">\(Y\)</span> và ngược lại. Mức độ tác động của <span class="math notranslate nohighlight">\(X\)</span> lên <span class="math notranslate nohighlight">\(Y\)</span> được biểu diễn bởi hệ số <span class="math notranslate nohighlight">\(\beta_{y,x}\)</span> và mức độ tác động của <span class="math notranslate nohighlight">\(Y\)</span> lên <span class="math notranslate nohighlight">\(X\)</span> được biểu diễn bởi hệ số <span class="math notranslate nohighlight">\(\beta_{x,y}\)</span>. Một cách đọc của <span class="math notranslate nohighlight">\(\beta_{y,x}\)</span>là: “mức độ ảnh hưởng của <span class="math notranslate nohighlight">\(x\)</span> lên <span class="math notranslate nohighlight">\(y\)</span>”. Các tham số <span class="math notranslate nohighlight">\(r_x\)</span> và <span class="math notranslate nohighlight">\(r_y\)</span> là những hằng số ảnh hưởng đến mức độ hỗn loạn (chaotic) của hệ thống. Khi ta tăng giá trị <span class="math notranslate nohighlight">\(r\)</span>, ví dụ khi <span class="math notranslate nohighlight">\(r &gt; 3.5\)</span>, hệ thống sẽ thể hiện hành vi ngày càng khó dự đoán (tức là hỗn loạn).</p>
<p><span class="math notranslate nohighlight">\(X(t+1)=X(t)[r_x-r_xX_t-\beta_{x,y}Y(t)]\)</span>
<br><span class="math notranslate nohighlight">\(Y(t+1)=Y(t)[r_y-r_yY_t-\beta_{y,x}X(t)]\)</span></p>
<p>Những câu hỏi then chốt cần ghi nhớ</p>
<ul class="simple">
<li><p>Liệu chúng ta có thể phát hiện mối quan hệ nhân quả hoặc sự tương tác giữa hai biến này chỉ bằng cách xem xét hệ số tương quan giữa chúng hay không?</p></li>
<li><p>Liệu Convergent Cross Mapping (CCM) có thể giúp chúng ta xác định được điều này hay không?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">jdc</span> <span class="c1"># used fo defining functions for a class in separate cells</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.spatial</span><span class="w"> </span><span class="kn">import</span> <span class="n">distance</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.interpolate</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_interp_spline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span> <span class="c1"># for showing progress bar in for loops</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">pearsonr</span>

<span class="c1">### Just to remove warnings to prettify the notebook. </span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/prince.javier/opt/anaconda3/lib/python3.7/site-packages/statsmodels/tools/_testing.py:19: FutureWarning: pandas.util.testing is deprecated. Use the functions in the public API at pandas.testing instead.
  import pandas.util.testing as tm
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">func_1</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">r</span> <span class="o">*</span> <span class="n">A</span> <span class="o">-</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># params</span>
<span class="n">r_x</span> <span class="o">=</span> <span class="mf">3.8</span>
<span class="n">r_y</span> <span class="o">=</span> <span class="mf">3.5</span>
<span class="n">B_xy</span> <span class="o">=</span> <span class="mf">0.02</span> <span class="c1"># effect on x given y (effect of y on x)</span>
<span class="n">B_yx</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># effect on y given x (effect of x on y)</span>

<span class="n">X0</span> <span class="o">=</span> <span class="mf">0.4</span> <span class="c1"># initial val</span>
<span class="n">Y0</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="c1"># initial val</span>
<span class="n">t</span> <span class="o">=</span> <span class="mi">5000</span> <span class="c1"># time steps</span>

<span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="n">X0</span><span class="p">]</span>
<span class="n">Y</span> <span class="o">=</span> <span class="p">[</span><span class="n">Y0</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="n">X_</span> <span class="o">=</span> <span class="n">func_1</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">Y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">r_x</span><span class="p">,</span> <span class="n">B_xy</span><span class="p">)</span>
    <span class="n">Y_</span> <span class="o">=</span> <span class="n">func_1</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">r_y</span><span class="p">,</span> <span class="n">B_yx</span><span class="p">)</span>    
    <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_</span><span class="p">)</span>
    <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Y_</span><span class="p">)</span>        
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">max_t</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="n">max_t</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.25</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Y</span><span class="p">[:</span><span class="n">max_t</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.25</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;timestep&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;value of X or Y&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7ff9b3824510&gt;
</pre></div>
</div>
<img alt="../_images/002c4ccff239d6f24dde97c59eb7475a39bb0c11c50a86a19f1e470942a664c3.png" src="../_images/002c4ccff239d6f24dde97c59eb7475a39bb0c11c50a86a19f1e470942a664c3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># correlations in the first 1000 time steps</span>
<span class="n">max_t</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:</span><span class="n">max_t</span><span class="p">],</span> <span class="n">Y</span><span class="p">[:</span><span class="n">max_t</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X(t)&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Y(t)&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">r</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">pearsonr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">r</span><span class="p">,</span> <span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4f130a51ba946885b718856a4741e306b90cbf2579e2b4b8784c5ae11d68e691.png" src="../_images/4f130a51ba946885b718856a4741e306b90cbf2579e2b4b8784c5ae11d68e691.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.005395539983091772, 0.8646878689811068)
</pre></div>
</div>
</div>
</div>
<p><strong>Thảo luận</strong></p>
<ul class="simple">
<li><p>Mặc dù chúng tôi đã xác định một cách tường minh rằng <span class="math notranslate nohighlight">\(Y\)</span> là một hàm của <span class="math notranslate nohighlight">\(X\)</span> (tức là <span class="math notranslate nohighlight">\(X\)</span> tác động lên <span class="math notranslate nohighlight">\(Y\)</span>), nhưng trong dài hạn, chúng tôi không tìm thấy mối tương quan giữa hai biến này.</p></li>
<li><p>Việc rút ra kết luận về mối quan hệ giữa <span class="math notranslate nohighlight">\(X\)</span> và <span class="math notranslate nohighlight">\(Y\)</span> (ví dụ: liệu <span class="math notranslate nohighlight">\(X\)</span> có ảnh hưởng đến <span class="math notranslate nohighlight">\(Y\)</span> hay ngược lại hay không) là rất khó nếu chỉ dựa trên đồ thị tương quan và giá trị hệ số tương quan.</p></li>
</ul>
</section>
<section id="ccm-algorithm">
<h2>CCM Algorithm<a class="headerlink" href="#ccm-algorithm" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Cho hai chuỗi thời gian</p></li>
</ol>
<p><span class="math notranslate nohighlight">\(X = \{X(1), X(2), ..., X(L)\}\)</span> và <span class="math notranslate nohighlight">\(Y = \{Y(1), Y(2), ..., Y(L)\}\)</span> trong đó <span class="math notranslate nohighlight">\(L\)</span> là độ dài của chuỗi thời gian.</p>
<ol class="arabic simple" start="2">
<li><p>Tính các vector tọa độ trễ (lagged-coordinate vectors), trong đó <span class="math notranslate nohighlight">\(E\)</span> là số chiều embedding.
Các thuật toán tìm kiếm (ví dụ: grid search) có thể được sử dụng để xác định giá trị E tối ưu. <span class="math notranslate nohighlight">\(\tau\)</span> là độ trễ (lag step)</p></li>
</ol>
<p><span class="math notranslate nohighlight">\(\underline{x}(t) = &lt;X(t), X(t-\tau), X(t-2\tau), ..., X(t-(E-1)\tau)&gt;\)</span> với <span class="math notranslate nohighlight">\(t \in [1+(E-1)\tau, L]\)</span></p>
<ol class="arabic simple" start="3">
<li><p>Định nghĩa đa tạp bóng (shadow / attractor manifold): <span class="math notranslate nohighlight">\(M_x = \{\underline{x}(t) \text{ for each } t \in [1+(E-1)\tau, L]\}\)</span></p></li>
<li><p>Tại thời điểm <span class="math notranslate nohighlight">\(t\)</span>, xác định vị trí của <span class="math notranslate nohighlight">\(\underline{x}(t)\)</span> trong đa tạp <span class="math notranslate nohighlight">\(M_x\)</span></p></li>
<li><p>Tìm <span class="math notranslate nohighlight">\(E+1\)</span> vector láng giềng gần nhất của <span class="math notranslate nohighlight">\(\underline{x}(t)\)</span>. Sugihara và cộng sự chỉ ra rằng <span class="math notranslate nohighlight">\(E+1\)</span> là số điểm tối thiểu cần thiết để tạo thành một simplex (embedding) trong không gian <span class="math notranslate nohighlight">\(E\)</span> chiều. Trực giác: nếu bạn có một ma trận 2 chiều, bạn cần 3 điểm (2 + 1) để “tam giác hóa” (triangulate) một điểm.</p></li>
<li><p>Ký hiệu các chỉ số thời gian của <span class="math notranslate nohighlight">\(E+1\)</span> láng giềng gần nhất của <span class="math notranslate nohighlight">\(\underline{x}(t)\)</span> lần lượt là <span class="math notranslate nohighlight">\(t_1, ..., t_{E+1}\)</span>. Các chỉ số này sẽ được sử dụng để xác định các điểm tương ứng trong chuỗi <span class="math notranslate nohighlight">\(Y\)</span>.</p></li>
<li><p>Định nghĩa mô hình dự đoán <span class="math notranslate nohighlight">\(Y\)</span> cho trước <span class="math notranslate nohighlight">\(M_x\)</span> như sau:
<span class="math notranslate nohighlight">\(\hat{Y} | M_x = \Sigma{w_iY(t_i)}\)</span> với <span class="math notranslate nohighlight">\(i = 1 ... E+1\)</span>, trong đó <span class="math notranslate nohighlight">\(w_i\)</span> là trọng số được nhân với giá trị tương ứng <span class="math notranslate nohighlight">\(Y(t_i)\)</span></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(w_i = u_i / \Sigma{u_j}\)</span> với <span class="math notranslate nohighlight">\(j = 1...E+1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(u_i = exp[-d(\underline{x}(t), \underline{x}(t_i))/d(\underline{x}(t), \underline{x}(t_1))]\)</span> trong đó <span class="math notranslate nohighlight">\(d(\underline{x}(s), \underline{x}(t))\)</span> là khoảng cách Euclid. Lưu ý rằng ta chia cho <span class="math notranslate nohighlight">\(d(x(t), x(t_1))\)</span> để chuẩn hóa khoảng cách, biểu diễn các khoảng cách như bội số của khoảng cách đến láng giềng gần nhất. Trực giác ở đây là: láng giềng càng xa thì trọng số càng nhỏ, theo hàm suy giảm mũ <span class="math notranslate nohighlight">\(exp^-k\)</span></p></li>
</ul>
</li>
<li><p>Nếu <span class="math notranslate nohighlight">\(X\)</span> và <span class="math notranslate nohighlight">\(Y\)</span> liên kết động lực (dynamically “coupled”), tức là một biến ảnh hưởng đến biến còn lại, thì một cụm điểm trong <span class="math notranslate nohighlight">\(M_x\)</span> sẽ tương ứng với một cụm điểm trong <span class="math notranslate nohighlight">\(M_y\)</span>. Khi <span class="math notranslate nohighlight">\(L\)</span> tăng, ta thu được các cụm <span class="math notranslate nohighlight">\(E+1\)</span> điểm dày đặc hơn trong <span class="math notranslate nohighlight">\(M_x\)</span>, và các cụm điểm tương ứng trong <span class="math notranslate nohighlight">\(M_y\)</span> cũng trở nên dày đặc hơn. Do đó, <span class="math notranslate nohighlight">\(\hat{Y} | M_x\)</span> theo trực giác sẽ hội tụ về <span class="math notranslate nohighlight">\(Y\)</span> khi <span class="math notranslate nohighlight">\(L\)</span> tăng, tức là khi có nhiều dữ liệu/mẫu hơn. Vì vậy, ta có thể kiểm tra sự hội tụ (convergence) của các láng giềng gần nhất để kiểm tra sự tương ứng giữa các trạng thái trên <span class="math notranslate nohighlight">\(M_x\)</span> và <span class="math notranslate nohighlight">\(M_y\)</span>.</p></li>
<li><p>Cuối cùng, ta vẽ hệ số tương quan giữa <span class="math notranslate nohighlight">\(Y\)</span> và <span class="math notranslate nohighlight">\(\hat{Y} | M_x\)</span>. Nếu tồn tại tương quan có ý nghĩa, điều này có nghĩa là đã có đủ thông tin từ <span class="math notranslate nohighlight">\(Y\)</span> được lưu trữ trong <span class="math notranslate nohighlight">\(X\)</span>. Khi đó, ta nói rằng <span class="math notranslate nohighlight">\(Y\)</span> ảnh hưởng đến <span class="math notranslate nohighlight">\(X\)</span>. Mặc dù điều này nghe có vẻ ngược trực giác, nhưng có thể hiểu theo cách khác như sau:
nếu <span class="math notranslate nohighlight">\(Y\)</span> ảnh hưởng đến <span class="math notranslate nohighlight">\(X\)</span>, thì thông tin từ <span class="math notranslate nohighlight">\(Y\)</span> được mã hóa trong <span class="math notranslate nohighlight">\(X\)</span>. Do đó, ta có thể sử dụng <span class="math notranslate nohighlight">\(X\)</span> để dự đoán <span class="math notranslate nohighlight">\(Y\)</span>. Lập luận tương tự cũng áp dụng cho trường hợp <span class="math notranslate nohighlight">\(X\)</span> ảnh hưởng đến <span class="math notranslate nohighlight">\(Y\)</span>.</p></li>
</ol>
<section id="dinh-nghia-cac-ham-trong-ccm">
<h3>Định nghĩa các hàm trong CCM<a class="headerlink" href="#dinh-nghia-cac-ham-trong-ccm" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Computing &quot;Causality&quot; (Correlation between True and Predictions)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ccm</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">E</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="mi">500</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        X: timeseries for variable X that could cause Y</span>
<span class="sd">        Y: timeseries for variable Y that could be caused by X</span>
<span class="sd">        tau: time lag</span>
<span class="sd">        E: shadow manifold embedding dimension</span>
<span class="sd">        L: time period/duration to consider (longer = more data)</span>
<span class="sd">        We&#39;re checking for X -&gt; Y</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tau</span> <span class="o">=</span> <span class="n">tau</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">E</span> <span class="o">=</span> <span class="n">E</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">L</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">My</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shadow_manifold</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="c1"># shadow manifold for Y (we want to know if info from X is in Y)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_steps</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dists</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_distances</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">My</span><span class="p">)</span> <span class="c1"># for distances between points in manifold    </span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">add_to</span> ccm
def shadow_manifold(self, X):
    &quot;&quot;&quot;
    Given
        X: some time series vector
        tau: lag step
        E: shadow manifold embedding dimension
        L: max time step to consider - 1 (starts from 0)
    Returns
        {t:[t, t-tau, t-2*tau ... t-(E-1)*tau]} = Shadow attractor manifold, dictionary of vectors
    &quot;&quot;&quot;
    X = X[:L] # make sure we cut at L
    M = {t:[] for t in range((self.E-1) * self.tau, self.L)} # shadow manifold
    for t in range((self.E-1) * self.tau, self.L):
        x_lag = [] # lagged values
        for t2 in range(0, self.E-1 + 1): # get lags, we add 1 to E-1 because we want to include E
            x_lag.append(X[t-t2*self.tau])            
        M[t] = x_lag
    return M
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">add_to</span> ccm

# get pairwise distances between vectors in X
def get_distances(self, Mx):
    &quot;&quot;&quot;
    Args
        Mx: The shadow manifold from X
    Returns
        t_steps: timesteps
        dists: n x n matrix showing distances of each vector at t_step (rows) from other vectors (columns)
    &quot;&quot;&quot;

    # we extract the time indices and vectors from the manifold Mx
    # we just want to be safe and convert the dictionary to a tuple (time, vector)
    # to preserve the time inds when we separate them
    t_vec = [(k, v) for k,v in Mx.items()]
    t_steps = np.array([i[0] for i in t_vec])
    vecs = np.array([i[1] for i in t_vec])
    dists = distance.cdist(vecs, vecs)    
    return t_steps, dists
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">add_to</span> ccm

def get_nearest_distances(self, t, t_steps, dists):
    &quot;&quot;&quot;
    Args:
        t: timestep of vector whose nearest neighbors we want to compute
        t_teps: time steps of all vectors in Mx, output of get_distances()
        dists: distance matrix showing distance of each vector (row) from other vectors (columns). output of get_distances()
        E: embedding dimension of shadow manifold Mx 
    Returns:
        nearest_timesteps: array of timesteps of E+1 vectors that are nearest to vector at time t
        nearest_distances: array of distances corresponding to vectors closest to vector at time t
    &quot;&quot;&quot;
    t_ind = np.where(t_steps == t) # get the index of time t
    dist_t = dists[t_ind].squeeze() # distances from vector at time t (this is one row)
    
    # get top closest vectors
    nearest_inds = np.argsort(dist_t)[1:self.E+1 + 1] # get indices sorted, we exclude 0 which is distance from itself
    nearest_timesteps = t_steps[nearest_inds] # index column-wise, t_steps are same column and row-wise 
    nearest_distances = dist_t[nearest_inds]  
    
    return nearest_timesteps, nearest_distances
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">add_to</span> ccm
def predict(self, t):
    &quot;&quot;&quot;
    Args
        t: timestep at Mx to predict Y at same time step
    Returns
        Y_true: the true value of Y at time t
        Y_hat: the predicted value of Y at time t using Mx
    &quot;&quot;&quot;
    eps = 0.000001 # epsilon minimum distance possible
    t_ind = np.where(self.t_steps == t) # get the index of time t
    dist_t = self.dists[t_ind].squeeze() # distances from vector at time t (this is one row)    
    nearest_timesteps, nearest_distances = self.get_nearest_distances(t, self.t_steps, self.dists)    
    
    # get weights
    u = np.exp(-nearest_distances/np.max([eps, nearest_distances[0]])) # we divide by the closest distance to scale
    w = u / np.sum(u)
    
    # get prediction of X
    X_true = self.X[t] # get corresponding true X
    X_cor = np.array(self.X)[nearest_timesteps] # get corresponding Y to cluster in Mx
    X_hat = (w * X_cor).sum() # get X_hat
    
    return X_true, X_hat
    
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">add_to</span> ccm
def causality(self):
    &#39;&#39;&#39;
    Args:
        None
    Returns:
        correl: how much self.X causes self.Y. correlation between predicted Y and true Y
    &#39;&#39;&#39;

    # run over all timesteps in M
    # X causes Y, we can predict X using My
    # X puts some info into Y that we can use to reverse engineer X from Y        
    X_true_list = []
    X_hat_list = []

    for t in list(self.My.keys()): # for each time step in My
        X_true, X_hat = self.predict(t) # predict X from My
        X_true_list.append(X_true)
        X_hat_list.append(X_hat) 

    x, y = X_true_list, X_hat_list
    r, p = pearsonr(x, y)        

    return r, p
</pre></div>
</div>
</div>
</div>
</section>
<section id="cac-ham-dung-de-truc-quan-hoa">
<h3>Các hàm dùng để trực quan hóa<a class="headerlink" href="#cac-ham-dung-de-truc-quan-hoa" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">add_to</span> ccm

def visualize_cross_mapping(self):
    &quot;&quot;&quot;
    Visualize the shadow manifolds and some cross mappings
    &quot;&quot;&quot;
    # we want to check cross mapping from Mx to My and My to Mx

    f, axs = plt.subplots(1, 2, figsize=(12, 6))        
    
    for i, ax in zip((0, 1), axs): # i will be used in switching Mx and My in Cross Mapping visualization
        #===============================================
        # Shadow Manifolds Visualization

        X_lag, Y_lag = [], []
        for t in range(1, len(self.X)):
            X_lag.append(X[t-tau])
            Y_lag.append(Y[t-tau])    
        X_t, Y_t = self.X[1:], self.Y[1:] # remove first value

        ax.scatter(X_t, X_lag, s=5, label=&#39;$M_x$&#39;)
        ax.scatter(Y_t, Y_lag, s=5, label=&#39;$M_y$&#39;, c=&#39;y&#39;)

        #===============================================
        # Cross Mapping Visualization

        A, B = [(self.Y, self.X), (self.X, self.Y)][i]
        cm_direction = [&#39;Mx to My&#39;, &#39;My to Mx&#39;][i]

        Ma = self.shadow_manifold(A)
        Mb = self.shadow_manifold(B)

        t_steps_A, dists_A = self.get_distances(Ma) # for distances between points in manifold
        t_steps_B, dists_B = self.get_distances(Mb) # for distances between points in manifold

        # Plot cross mapping for different time steps
        timesteps = list(Ma.keys())
        for t in np.random.choice(timesteps, size=3, replace=False):
            Ma_t = Ma[t]
            near_t_A, near_d_A = self.get_nearest_distances(t, t_steps_A, dists_A)

            for i in range(E+1):
                # points on Ma
                A_t = Ma[near_t_A[i]][0]
                A_lag = Ma[near_t_A[i]][1]
                ax.scatter(A_t, A_lag, c=&#39;b&#39;, marker=&#39;s&#39;)

                # corresponding points on Mb
                B_t = Mb[near_t_A[i]][0]
                B_lag = Mb[near_t_A[i]][1]
                ax.scatter(B_t, B_lag, c=&#39;r&#39;, marker=&#39;*&#39;, s=50)  

                # connections
                ax.plot([A_t, B_t], [A_lag, B_lag], c=&#39;r&#39;, linestyle=&#39;:&#39;) 

        ax.set_title(f&#39;{cm_direction} cross mapping. time lag, tau = {tau}, E = 2&#39;)
        ax.legend(prop={&#39;size&#39;: 14})

        ax.set_xlabel(&#39;$X_t$, $Y_t$&#39;, size=15)
        ax.set_ylabel(&#39;$X_{t-1}$, $Y_{t-1}$&#39;, size=15)               
    plt.show()       
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">add_to</span> ccm
def plot_ccm_correls(self):
    &quot;&quot;&quot;
    Args
        X: X time series
        Y: Y time series
        tau: time lag
        E: shadow manifold embedding dimension
        L: time duration
    Returns
        None. Just correlation plots
    &quot;&quot;&quot;
    M = self.shadow_manifold(self.Y) # shadow manifold
    t_steps, dists = self.get_distances(M) # for distances

    ccm_XY = ccm(X, Y, tau, E, L) # define new ccm object # Testing for X -&gt; Y
    ccm_YX = ccm(Y, X, tau, E, L) # define new ccm object # Testing for Y -&gt; X

    X_My_true, X_My_pred = [], [] # note pred X | My is equivalent to figuring out if X -&gt; Y
    Y_Mx_true, Y_Mx_pred = [], [] # note pred Y | Mx is equivalent to figuring out if Y -&gt; X

    for t in range(tau, L):
        true, pred = ccm_XY.predict(t)
        X_My_true.append(true)
        X_My_pred.append(pred)    

        true, pred = ccm_YX.predict(t)
        Y_Mx_true.append(true)
        Y_Mx_pred.append(pred)        

    # # plot
    figs, axs = plt.subplots(1, 2, figsize=(12, 5))
    
    # predicting X from My
    r, p = np.round(pearsonr(X_My_true, X_My_pred), 4)
    
    axs[0].scatter(X_My_true, X_My_pred, s=10)
    axs[0].set_xlabel(&#39;$X(t)$ (observed)&#39;, size=12)
    axs[0].set_ylabel(&#39;$\hat{X}(t)|M_y$ (estimated)&#39;, size=12)
    axs[0].set_title(f&#39;tau={tau}, E={E}, L={L}, Correlation coeff = {r}&#39;)

    # predicting Y from Mx
    r, p = np.round(pearsonr(Y_Mx_true, Y_Mx_pred), 4)
    
    axs[1].scatter(Y_Mx_true, Y_Mx_pred, s=10)
    axs[1].set_xlabel(&#39;$Y(t)$ (observed)&#39;, size=12)
    axs[1].set_ylabel(&#39;$\hat{Y}(t)|M_x$ (estimated)&#39;, size=12)
    axs[1].set_title(f&#39;tau={tau}, E={E}, L={L}, Correlation coeff = {r}&#39;)
    plt.show()
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="applying-ccm-to-our-sample-systems">
<h2>Applying CCM to our Sample Systems<a class="headerlink" href="#applying-ccm-to-our-sample-systems" title="Permalink to this heading">#</a></h2>
<section id="ccm-co-the-du-doan-quan-he-nhan-qua-trong-he-kiem-thu-cua-chung-ta-khong">
<h3>CCM có thể dự đoán quan hệ nhân quả trong hệ kiểm thử của chúng ta không?<a class="headerlink" href="#ccm-co-the-du-doan-quan-he-nhan-qua-trong-he-kiem-thu-cua-chung-ta-khong" title="Permalink to this heading">#</a></h3>
<p>Hãy nhớ rằng hệ kiểm thử của chúng ta được xác định như sau:</p>
<p><span class="math notranslate nohighlight">\(X(t+1)=X(t)[r_x-r_xX_t-\beta_{x,y}Y(t)]\)</span>
<br><span class="math notranslate nohighlight">\(Y(t+1)=Y(t)[r_y-r_yY_t-\beta_{y,x}X(t)]\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize test dataset</span>
<span class="c1"># params</span>
<span class="n">r_x</span> <span class="o">=</span> <span class="mf">3.8</span>
<span class="n">r_y</span> <span class="o">=</span> <span class="mf">3.5</span>
<span class="n">B_xy</span> <span class="o">=</span> <span class="mf">0.02</span> <span class="c1"># effect on x given y (effect of y on x)</span>
<span class="n">B_yx</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># effect on y given x (effect of x on y)</span>

<span class="n">X0</span> <span class="o">=</span> <span class="mf">0.4</span> <span class="c1"># initial val</span>
<span class="n">Y0</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="c1"># initial val</span>
<span class="n">t</span> <span class="o">=</span> <span class="mi">5000</span> <span class="c1"># time steps</span>

<span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="n">X0</span><span class="p">]</span>
<span class="n">Y</span> <span class="o">=</span> <span class="p">[</span><span class="n">Y0</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="n">X_</span> <span class="o">=</span> <span class="n">func_1</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">Y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">r_x</span><span class="p">,</span> <span class="n">B_xy</span><span class="p">)</span>
    <span class="n">Y_</span> <span class="o">=</span> <span class="n">func_1</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">r_y</span><span class="p">,</span> <span class="n">B_yx</span><span class="p">)</span>    
    <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_</span><span class="p">)</span>
    <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Y_</span><span class="p">)</span>        
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize simple shadow manifolds Mx and My for different tau</span>
<span class="c1"># We visualize Cross-Mapping</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># we fix the seed when randomly choosing cross mapping points</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># time lag</span>
<span class="n">E</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># shadow manifold embedding dimensions</span>
<span class="n">L</span> <span class="o">=</span> <span class="mi">500</span> <span class="c1"># length of time period to consider</span>

<span class="n">ccm1</span> <span class="o">=</span> <span class="n">ccm</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span>
<span class="n">ccm1</span><span class="o">.</span><span class="n">visualize_cross_mapping</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8c5895f1dd56b3fa3d1e7e2d99b0d86cd707a6d7351a440e63ceb2eac23e48ee.png" src="../_images/8c5895f1dd56b3fa3d1e7e2d99b0d86cd707a6d7351a440e63ceb2eac23e48ee.png" />
</div>
</div>
<p><strong>Thảo luận</strong></p>
<ul class="simple">
<li><p>Trong các đa tạp bóng (shadow manifolds) ở trên, chúng ta minh họa phép ánh xạ chéo (cross mapping) của các điểm từ một đa tạp (khung màu xanh) sang các điểm tương ứng trên đa tạp còn lại (ngôi sao màu đỏ).</p></li>
<li><p>Nếu các giá trị từ một đa tạp, ví dụ <span class="math notranslate nohighlight">\(M_x\)</span>, ánh xạ chéo một cách phân tán sang các giá trị trên đa tạp khác, ví dụ <span class="math notranslate nohighlight">\(M_y\)</span>, điều này có nghĩa là chúng ta không thể dự đoán chính xác <span class="math notranslate nohighlight">\(M_y\)</span> hoặc <span class="math notranslate nohighlight">\(Y\)</span> khi biết <span class="math notranslate nohighlight">\(M_x\)</span>. Điều này hàm ý rằng không có nhiều thông tin từ <span class="math notranslate nohighlight">\(Y\)</span> được truyền sang <span class="math notranslate nohighlight">\(X\)</span> để tạo ra các dự đoán có độ chính xác cao. Nói cách khác, <span class="math notranslate nohighlight">\(Y\)</span> có thể tác động lên <span class="math notranslate nohighlight">\(X\)</span> nhưng mức độ tác động là không lớn.</p></li>
<li><p>Mối quan hệ nhân quả giữa các biến càng mạnh thì phép ánh xạ chéo càng hẹp. Ví dụ, ánh xạ chéo của <span class="math notranslate nohighlight">\(M_x\)</span> từ <span class="math notranslate nohighlight">\(M_y\)</span> (biểu đồ bên trái) có độ hẹp tương đối, điều này có thể hàm ý rằng <span class="math notranslate nohighlight">\(X\)</span> tác động lên <span class="math notranslate nohighlight">\(Y\)</span>.</p></li>
<li><p>Mặc dù sự hội tụ hẹp của ánh xạ chéo có thể chỉ ra quan hệ nhân quả, nhưng đây chỉ là một trong hai tiêu chí để kết luận quan hệ nhân quả. Chúng ta còn cần thỏa mãn điều kiện hội tụ (convergence), sẽ được thảo luận tiếp theo.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># let us plot the performance of the cross mapping predictions using correlation</span>
<span class="n">L</span> <span class="o">=</span> <span class="mi">3000</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">E</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">ccm1</span><span class="o">.</span><span class="n">plot_ccm_correls</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ebdd56d51e19ef9c9885198c50036491c7f97debc7bf5ac4e1ec06311da4bf0c.png" src="../_images/ebdd56d51e19ef9c9885198c50036491c7f97debc7bf5ac4e1ec06311da4bf0c.png" />
</div>
</div>
<p><strong>Thảo luận</strong></p>
<ul class="simple">
<li><p>Chúng ta đo lường phép ánh xạ chéo (cross mapping) bằng hệ số tương quan. Tương quan càng mạnh là một chỉ báo cho quan hệ nhân quả càng mạnh.</p></li>
<li><p>Biểu đồ bên trái cho thấy hiệu năng của phép ánh xạ chéo từ <span class="math notranslate nohighlight">\(M_y\)</span> sang <span class="math notranslate nohighlight">\(M_x\)</span> để dự đoán <span class="math notranslate nohighlight">\(X(t)\)</span>. Điều này có nghĩa là chúng ta có thể dự đoán <span class="math notranslate nohighlight">\(X\)</span> khi biết <span class="math notranslate nohighlight">\(Y\)</span>, điều xảy ra khi <span class="math notranslate nohighlight">\(Y\)</span> chứa đủ thông tin về <span class="math notranslate nohighlight">\(X\)</span>. Khi đó, ta nói rằng <span class="math notranslate nohighlight">\(X\)</span> tác động mạnh hoặc gây ra <span class="math notranslate nohighlight">\(Y\)</span>. Hãy nhớ trực giác rằng nếu <span class="math notranslate nohighlight">\(X\)</span> gây ra <span class="math notranslate nohighlight">\(Y\)</span> thì thông tin từ <span class="math notranslate nohighlight">\(X\)</span> sẽ được truyền sang <span class="math notranslate nohighlight">\(Y\)</span>.</p></li>
<li><p>Chúng ta đã trình bày phép ánh xạ chéo theo cả hai hướng, mặc dù một hướng mạnh hơn hướng còn lại.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Looking at &quot;convergence&quot;</span>
<span class="n">L_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">3200</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span> <span class="c1"># L values to test</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">E</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">Xhat_My</span><span class="p">,</span> <span class="n">Yhat_Mx</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span> <span class="c1"># correlation list</span>
<span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">L_range</span><span class="p">:</span> 
    <span class="n">ccm_XY</span> <span class="o">=</span> <span class="n">ccm</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="c1"># define new ccm object # Testing for X -&gt; Y</span>
    <span class="n">ccm_YX</span> <span class="o">=</span> <span class="n">ccm</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="c1"># define new ccm object # Testing for Y -&gt; X    </span>
    <span class="n">Xhat_My</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ccm_XY</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> 
    <span class="n">Yhat_Mx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ccm_YX</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> 
    
<span class="c1"># plot convergence as L-&gt;inf. Convergence is necessary to conclude causality</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">L_range</span><span class="p">,</span> <span class="n">Xhat_My</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\hat</span><span class="si">{X}</span><span class="s1">(t)|M_y$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">L_range</span><span class="p">,</span> <span class="n">Yhat_Mx</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\hat</span><span class="si">{Y}</span><span class="s1">(t)|M_x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;correl&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7ff9a1bb3c10&gt;
</pre></div>
</div>
<img alt="../_images/f02578ae79fb6be480322aed7771d5766ca9f25c5dc640223566a7df9e7f5f0a.png" src="../_images/f02578ae79fb6be480322aed7771d5766ca9f25c5dc640223566a7df9e7f5f0a.png" />
</div>
</div>
<p><strong>Thảo luận</strong></p>
<ul class="simple">
<li><p>Hội tụ (convergence) có nghĩa là chúng ta có thể cải thiện độ chính xác của phép ánh xạ chéo khi khoảng thời gian quan sát <span class="math notranslate nohighlight">\(L\)</span> tăng lên. Nhắc lại, điều này chỉ xảy ra khi chúng ta có thể cải thiện việc tái dựng bộ hút chung (shared attractor) giữa hai biến bằng cách sử dụng nhiều dữ liệu hơn.</p></li>
<li><p>Trong biểu đồ ở trên, ta thấy rằng cả hai phép ánh xạ chéo đều hội tụ, tuy nhiên một phép hội tụ mạnh hơn phép còn lại. Như vậy, chúng ta đã thỏa mãn hai tiêu chí của CCM: hội tụ và ánh xạ chéo. Do đó, ta có thể nói rằng tồn tại quan hệ nhân quả. Tuy nhiên, độ lớn của quan hệ nhân quả theo mỗi hướng là khác nhau.</p></li>
<li><p>Từ biểu đồ này, chúng ta có thể kết luận điều gì về sự tương tác giữa <span class="math notranslate nohighlight">\(X\)</span> và <span class="math notranslate nohighlight">\(Y\)</span>?</p></li>
<li><p>Biến nào có ảnh hưởng lớn hơn lên biến còn lại?</p></li>
</ul>
</section>
<section id="cach-cac-he-so-beta-anh-huong-den-quan-he-nhan-qua-duoc-the-hien-thong-qua-su-hoi-tu">
<h3>Cách các hệ số Beta ảnh hưởng đến quan hệ nhân quả được thể hiện thông qua sự hội tụ<a class="headerlink" href="#cach-cac-he-so-beta-anh-huong-den-quan-he-nhan-qua-duoc-the-hien-thong-qua-su-hoi-tu" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Checking convergence for various betas</span>
<span class="c1"># params</span>
<span class="n">X0</span> <span class="o">=</span> <span class="mf">0.4</span> <span class="c1"># initial val</span>
<span class="n">Y0</span> <span class="o">=</span> <span class="mf">0.4</span> <span class="c1"># initial val</span>
<span class="n">t</span> <span class="o">=</span> <span class="mi">400</span> <span class="c1"># time steps for the dataset</span>
<span class="n">L</span> <span class="o">=</span> <span class="mi">400</span> <span class="c1"># time steps for computing CCM</span>
<span class="n">E</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># embedding dimensions</span>

<span class="n">range_</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.41</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">))</span> <span class="c1"># B ranges</span>
<span class="n">correl_diffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">range_</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">range_</span><span class="p">)))</span> <span class="c1"># correlation list</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ind_B_xy</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">range_</span><span class="p">)):</span> <span class="c1"># effect on x given y (effect of y on x)</span>
    <span class="k">for</span> <span class="n">ind_B_yx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">range_</span><span class="p">)):</span> <span class="c1"># effect on y given x (effect of x on y)</span>
        
        <span class="n">r_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">3.6</span><span class="p">,</span> <span class="mf">4.1</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">))</span> <span class="c1"># paper implies random sampling</span>
        <span class="n">r_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">3.6</span><span class="p">,</span> <span class="mf">4.1</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">))</span> <span class="c1"># paper implies random sampling</span>

        <span class="n">B_xy</span> <span class="o">=</span> <span class="n">range_</span><span class="p">[</span><span class="n">ind_B_xy</span><span class="p">]</span>
        <span class="n">B_yx</span> <span class="o">=</span> <span class="n">range_</span><span class="p">[</span><span class="n">ind_B_yx</span><span class="p">]</span>
        
        <span class="c1"># initialize dataset</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="p">[</span><span class="n">X0</span><span class="p">],</span> <span class="p">[</span><span class="n">Y0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
            <span class="n">X_</span> <span class="o">=</span> <span class="n">func_1</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">Y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">r_x</span><span class="p">,</span> <span class="n">B_xy</span><span class="p">)</span>
            <span class="n">Y_</span> <span class="o">=</span> <span class="n">func_1</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">r_y</span><span class="p">,</span> <span class="n">B_yx</span><span class="p">)</span>    
            <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_</span><span class="p">)</span>
            <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Y_</span><span class="p">)</span>

        <span class="c1"># there are some combinations that throw an error</span>
        <span class="c1"># couldn&#39;t find the cause but to be fair, Sugihara et al also had &quot;holes&quot; in their chart</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Testing for X -&gt; Y</span>
            <span class="n">ccm_XY</span> <span class="o">=</span> <span class="n">ccm</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="c1"># define new ccm object</span>
            <span class="n">correl_xy</span> <span class="o">=</span> <span class="n">ccm_XY</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>          

            <span class="c1"># Testing for Y -&gt; X</span>
            <span class="n">ccm_YX</span> <span class="o">=</span> <span class="n">ccm</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="c1"># define new ccm object</span>
            <span class="n">correl_yx</span> <span class="o">=</span> <span class="n">ccm_YX</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

            <span class="c1"># get diffs </span>
            <span class="n">correl_diffs</span><span class="p">[</span><span class="n">ind_B_yx</span><span class="p">][</span><span class="n">ind_B_xy</span><span class="p">]</span> <span class="o">=</span> <span class="n">correl_yx</span> <span class="o">-</span> <span class="n">correl_xy</span> <span class="c1"># (y -&gt; x) - (x-&gt; y)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">continue</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">correl_diffs</span><span class="p">),</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">fignum</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Beta_x_y&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Beta_y_x&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;$correl(\hat</span><span class="si">{Y}</span><span class="s1">(t)|M_x) - correl(\hat</span><span class="si">{X}</span><span class="s1">(t)|M_y$)&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="c1"># plt.xticks(range(len(range_)), np.round(range_, 2), rotation=90)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">range_</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">range_</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/bf96fc7a44b201185f888aac56bbde248e4baa5d06fc2b86bb15cdeb16030344.png" src="../_images/bf96fc7a44b201185f888aac56bbde248e4baa5d06fc2b86bb15cdeb16030344.png" />
</div>
</div>
<p><strong>Thảo luận</strong></p>
<p>Biểu đồ phía trên cho thấy sự khác biệt về hiệu năng dự báo
<span class="math notranslate nohighlight">\(\rho(\hat{Y}\mid M_x) - \rho(\hat{X}\mid M_y)\)</span>
đối với các giá trị khác nhau của <span class="math notranslate nohighlight">\(\beta_{y,x}\)</span> và <span class="math notranslate nohighlight">\(\beta_{x,y}\)</span>. Hãy nhớ rằng <span class="math notranslate nohighlight">\(\beta_{y,x}\)</span> biểu thị mức độ mà <span class="math notranslate nohighlight">\(X\)</span> ảnh hưởng đến <span class="math notranslate nohighlight">\(Y\)</span>, và rằng giá trị <span class="math notranslate nohighlight">\(\rho(\hat{X}\mid M_y)\)</span> càng cao thì điều đó có nghĩa là chúng ta có thể dự báo <span class="math notranslate nohighlight">\(X\)</span> từ <span class="math notranslate nohighlight">\(Y\)</span> tốt hơn, cho thấy rằng phần lớn thông tin từ <span class="math notranslate nohighlight">\(X\)</span> được “lưu trữ” trong <span class="math notranslate nohighlight">\(Y\)</span>, hay nói cách khác, <span class="math notranslate nohighlight">\(X\)</span> gây ra <span class="math notranslate nohighlight">\(Y\)</span>.</p>
<p>Lưu ý rằng các “đốm” (spots) trong biểu đồ có thể xuất hiện do việc chúng ta ngẫu nhiên hóa giá trị của <span class="math notranslate nohighlight">\(r_x\)</span> và <span class="math notranslate nohighlight">\(r_y\)</span> trong mỗi vòng lặp. (Chúng tôi làm theo phương pháp ngẫu nhiên hóa <span class="math notranslate nohighlight">\(r\)</span> như được ngụ ý trong phần tài liệu bổ sung của bài báo Sugihara et al.. Biểu đồ của họ cũng có các đốm tương tự.)</p>
<ul class="simple">
<li><p>Dựa trên biểu đồ, khi <span class="math notranslate nohighlight">\(\beta_{y,x}\)</span> tăng lên, điều gì xảy ra với các dự báo <span class="math notranslate nohighlight">\(\hat{Y}\mid M_x\)</span> và <span class="math notranslate nohighlight">\(\hat{X}\mid M_y\)</span>?</p></li>
<li><p>Các kết quả này có phù hợp với trực giác của chúng ta rằng <span class="math notranslate nohighlight">\(\beta_{y,x}\)</span> lớn hơn thì tác động của <span class="math notranslate nohighlight">\(X\)</span> lên <span class="math notranslate nohighlight">\(Y\)</span> cũng lớn hơn hay không?</p></li>
</ul>
</section>
<section id="dieu-gi-xay-ra-neu-he-duoc-ghep-noi-bat-doi-xung-tac-dong-chi-theo-mot-chieu">
<h3>Điều gì xảy ra nếu hệ được ghép nối bất đối xứng (tác động chỉ theo một chiều)?<a class="headerlink" href="#dieu-gi-xay-ra-neu-he-duoc-ghep-noi-bat-doi-xung-tac-dong-chi-theo-mot-chieu" title="Permalink to this heading">#</a></h3>
<p>Hãy định nghĩa hệ của chúng ta như sau:</p>
<p><span class="math notranslate nohighlight">\(X(t+1)=X(t)[3.7-3.7X_t-0Y(t)]\)</span>
<br><span class="math notranslate nohighlight">\(Y(t+1)=Y(t)[3.7-3.7Y_t-0.32X(t)]\)</span></p>
<p>Chúng ta có bị thuyết phục rằng hệ này chỉ có quan hệ nhân quả theo một chiều duy nhất hay không?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize test dataset</span>
<span class="c1"># params</span>
<span class="n">r_x</span> <span class="o">=</span> <span class="mf">3.7</span>
<span class="n">r_y</span> <span class="o">=</span> <span class="mf">3.7</span>
<span class="n">B_xy</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># effect on x given y (effect of y on x)</span>
<span class="n">B_yx</span> <span class="o">=</span> <span class="mf">0.32</span> <span class="c1"># effect on y given x (effect of x on y)</span>

<span class="n">X0</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="c1"># initial val following Sugihara et al</span>
<span class="n">Y0</span> <span class="o">=</span> <span class="mf">0.4</span> <span class="c1"># initial val following Sugihara et al</span>
<span class="n">t</span> <span class="o">=</span> <span class="mi">3000</span> <span class="c1"># time steps</span>

<span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="n">X0</span><span class="p">]</span>
<span class="n">Y</span> <span class="o">=</span> <span class="p">[</span><span class="n">Y0</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="n">X_</span> <span class="o">=</span> <span class="n">func_1</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">Y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">r_x</span><span class="p">,</span> <span class="n">B_xy</span><span class="p">)</span>
    <span class="n">Y_</span> <span class="o">=</span> <span class="n">func_1</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">r_y</span><span class="p">,</span> <span class="n">B_yx</span><span class="p">)</span>    
    <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_</span><span class="p">)</span>
    <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Y_</span><span class="p">)</span>        
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">max_t</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="n">max_t</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.25</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Y</span><span class="p">[:</span><span class="n">max_t</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.25</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;timestep&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;value of X or Y&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7ff9b68dfb90&gt;
</pre></div>
</div>
<img alt="../_images/f767c4e6a6a14afb3b92d495c9063f73e81f4d1da220d6dbee56731b31cae36a.png" src="../_images/f767c4e6a6a14afb3b92d495c9063f73e81f4d1da220d6dbee56731b31cae36a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># correlations in the first 1000 time steps</span>
<span class="n">max_t</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:</span><span class="n">max_t</span><span class="p">],</span> <span class="n">Y</span><span class="p">[:</span><span class="n">max_t</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X(t)&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Y(t)&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1"># np.corrcoef(x, y)[0][1]</span>
<span class="n">r</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">pearsonr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">r</span><span class="p">,</span> <span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0655e5ec698cdf80d80ed696f509e31c65c89f4ddc7fc3ceddefff92f86d757e.png" src="../_images/0655e5ec698cdf80d80ed696f509e31c65c89f4ddc7fc3ceddefff92f86d757e.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.24813484131913208, 1.6963889777954784e-15)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize simple shadow manifolds Mx and My for different tau</span>
<span class="c1"># We visualize Cross-Mapping</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span> <span class="c1"># we fix the seed when randomly choosing cross mapping points</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># time lag</span>
<span class="n">E</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># shadow manifold embedding dimensions</span>
<span class="n">L</span> <span class="o">=</span> <span class="mi">500</span> <span class="c1"># length of time period to consider</span>

<span class="n">ccm1</span> <span class="o">=</span> <span class="n">ccm</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span>
<span class="n">ccm1</span><span class="o">.</span><span class="n">visualize_cross_mapping</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/640c58dfd1af9661b6e090dd2cec092d279b393801cccd7d78d80f2312ec2017.png" src="../_images/640c58dfd1af9661b6e090dd2cec092d279b393801cccd7d78d80f2312ec2017.png" />
</div>
</div>
<p><strong>Thảo luận</strong></p>
<ul class="simple">
<li><p>Chúng ta có thể quan sát được điều gì về các phép cross mapping giữa hai đa tạp trong hệ này? Hãy nhớ rằng hướng của cross mapping là từ các ô vuông màu xanh sang các ngôi sao màu đỏ.</p></li>
<li><p>Đây có phải là điều mà chúng ta đã kỳ vọng hay không?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># let us plot the performance of the cross mapping predictions using correlation</span>
<span class="n">L</span> <span class="o">=</span> <span class="mi">3000</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">E</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">ccm1</span><span class="o">.</span><span class="n">plot_ccm_correls</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b25e9ffc8756eefc3f296ad709c6d0ec9d9125b864211528ec47281c6ba188e9.png" src="../_images/b25e9ffc8756eefc3f296ad709c6d0ec9d9125b864211528ec47281c6ba188e9.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Looking at &quot;convergence&quot;</span>
<span class="n">L_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="c1"># L values to test</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">E</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">Xhat_My</span><span class="p">,</span> <span class="n">Yhat_Mx</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span> <span class="c1"># correlation list</span>
<span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">L_range</span><span class="p">:</span> 
    <span class="n">ccm_XY</span> <span class="o">=</span> <span class="n">ccm</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="c1"># define new ccm object # Testing for X -&gt; Y</span>
    <span class="n">ccm_YX</span> <span class="o">=</span> <span class="n">ccm</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="c1"># define new ccm object # Testing for Y -&gt; X    </span>
    <span class="n">Xhat_My</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ccm_XY</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> 
    <span class="n">Yhat_Mx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ccm_YX</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> 
    
<span class="c1"># plot convergence as L-&gt;inf. Convergence is necessary to conclude causality</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">L_range</span><span class="p">,</span> <span class="n">Xhat_My</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\hat</span><span class="si">{X}</span><span class="s1">(t)|M_y$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">L_range</span><span class="p">,</span> <span class="n">Yhat_Mx</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\hat</span><span class="si">{Y}</span><span class="s1">(t)|M_x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;correl&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>   

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;X-&gt;Y r&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Xhat_My</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;p value&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ccm_XY</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Y-&gt;X r&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Yhat_Mx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;p value&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ccm_YX</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X-&gt;Y r 0.99 p value 0.0
Y-&gt;X r 0.09 p value 0.0
</pre></div>
</div>
<img alt="../_images/1e81ab8f59b3b09b770c2bcae6ed013b12fd31b8129737cd5e414f8905d11624.png" src="../_images/1e81ab8f59b3b09b770c2bcae6ed013b12fd31b8129737cd5e414f8905d11624.png" />
</div>
</div>
<p><strong>Thảo luận</strong></p>
<ul class="simple">
<li><p>Chúng ta diễn giải các biểu đồ này như thế nào trong bối cảnh xác định quan hệ nhân quả bằng khung CCM?</p></li>
<li><p>Các kết quả ở đây có đúng như những gì chúng ta kỳ vọng hay không?</p></li>
</ul>
</section>
</section>
<section id="anh-huong-cua-strong-forcing-tac-dong-cuong-buc-manh">
<h2>Ảnh hưởng của “Strong Forcing” (tác động cưỡng bức mạnh)<a class="headerlink" href="#anh-huong-cua-strong-forcing-tac-dong-cuong-buc-manh" title="Permalink to this heading">#</a></h2>
<p>Điều gì xảy ra với kết quả của CCM khi <span class="math notranslate nohighlight">\(X\)</span> có tác động rất mạnh lên <span class="math notranslate nohighlight">\(Y\)</span> nhưng <span class="math notranslate nohighlight">\(Y\)</span> lại không có bất kỳ tác động nào lên <span class="math notranslate nohighlight">\(X\)</span>?</p>
<p><span class="math notranslate nohighlight">\(X(t+1)=X(t)[3.7-3.7X_t-0Y(t)]\)</span>
<br><span class="math notranslate nohighlight">\(Y(t+1)=Y(t)[3.7-3.7Y_t- \beta_{yx} X(t)] \text{ trong đó } \beta_{yx} \text{là lớn}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize test dataset</span>
<span class="c1"># params</span>

<span class="c1"># values for B_yx</span>
<span class="c1"># we query an array using B_yx_dict[B_yx value][X or Y]</span>
<span class="n">B_yx_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">2</span><span class="p">):{</span><span class="s1">&#39;X&#39;</span><span class="p">:[],</span> <span class="s1">&#39;Y&#39;</span><span class="p">:[]}</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)}</span>

<span class="n">r_x</span> <span class="o">=</span> <span class="mf">3.7</span>
<span class="n">r_y</span> <span class="o">=</span> <span class="mf">3.7</span>

<span class="n">X0</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="c1"># initial val following Sugihara et al</span>
<span class="n">Y0</span> <span class="o">=</span> <span class="mf">0.4</span> <span class="c1"># initial val following Sugihara et al</span>
<span class="n">t</span> <span class="o">=</span> <span class="mi">2000</span> <span class="c1"># time steps</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">B_yx_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>    
    <span class="n">B_xy</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># effect on x given y (effect of y on x)</span>
    <span class="n">B_yx</span> <span class="o">=</span> <span class="n">k</span> <span class="c1"># effect on y given x (effect of x on y)    </span>
    
    <span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="n">X0</span><span class="p">]</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="p">[</span><span class="n">Y0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
        <span class="n">X_</span> <span class="o">=</span> <span class="n">func_1</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">Y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">r_x</span><span class="p">,</span> <span class="n">B_xy</span><span class="p">)</span>
        <span class="n">Y_</span> <span class="o">=</span> <span class="n">func_1</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">r_y</span><span class="p">,</span> <span class="n">B_yx</span><span class="p">)</span>    
        <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_</span><span class="p">)</span>
        <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Y_</span><span class="p">)</span> 
    <span class="n">B_yx_dict</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;X&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">X</span>
    <span class="n">B_yx_dict</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">Y</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Looking at &quot;convergence&quot; for different B_yx values</span>
<span class="n">L_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="c1"># L values to test</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">E</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">B_yx_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">L_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">Yhat_Mx_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">Xhat_My_list</span> <span class="o">=</span> <span class="p">[]</span>


<span class="k">for</span> <span class="n">B_yx</span> <span class="ow">in</span> <span class="n">B_yx_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">B_yx_dict</span><span class="p">[</span><span class="n">B_yx</span><span class="p">][</span><span class="s1">&#39;X&#39;</span><span class="p">]</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">B_yx_dict</span><span class="p">[</span><span class="n">B_yx</span><span class="p">][</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span>    

    <span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">L_range</span><span class="p">:</span> 
        <span class="n">ccm_XY</span> <span class="o">=</span> <span class="n">ccm</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="c1"># define new ccm object # Testing for X -&gt; Y</span>
        <span class="n">ccm_YX</span> <span class="o">=</span> <span class="n">ccm</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="c1"># define new ccm object # Testing for Y -&gt; X    </span>
        
        <span class="n">B_yx_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">B_yx</span><span class="p">)</span>
        <span class="n">L_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
        <span class="n">Xhat_My_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ccm_XY</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># wont be used        </span>
        <span class="n">Yhat_Mx_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ccm_YX</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">mpl_toolkits.mplot3d</span><span class="w"> </span><span class="kn">import</span> <span class="n">Axes3D</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">L_list</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">B_yx_list</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Yhat_Mx_list</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot_trisurf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">antialiased</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$B_</span><span class="si">{yx}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;correl $\hat</span><span class="si">{Y}</span><span class="s1">|M_x$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/44ed7965ffb34c987afce538fc3d486060cd688c74a060fbe2adc9c15cfc1758.png" src="../_images/44ed7965ffb34c987afce538fc3d486060cd688c74a060fbe2adc9c15cfc1758.png" />
</div>
</div>
<p><strong>Thảo luận</strong></p>
<ul class="simple">
<li><p>Hãy nhớ rằng nếu <span class="math notranslate nohighlight">\(Y\)</span> gây ra <span class="math notranslate nohighlight">\(X\)</span>, thì thông tin từ <span class="math notranslate nohighlight">\(Y\)</span> sẽ được “nhúng” (embedded) vào <span class="math notranslate nohighlight">\(X\)</span>, và khi đó ta sẽ có thể dự đoán <span class="math notranslate nohighlight">\(Y\)</span> dựa trên đa tạp bóng (shadow manifold) <span class="math notranslate nohighlight">\(M_x\)</span>.</p></li>
<li><p>Tuy nhiên, chúng ta nhận thấy rằng mặc dù <span class="math notranslate nohighlight">\(Y\)</span> không hề có ảnh hưởng lên <span class="math notranslate nohighlight">\(X\)</span>, CCM vẫn cho kết quả cross mapping rất cao nếu mức độ ảnh hưởng của <span class="math notranslate nohighlight">\(X\)</span> lên <span class="math notranslate nohighlight">\(Y\)</span>, tức <span class="math notranslate nohighlight">\(\beta_{yx}\)</span>, là rất lớn. Hiện tượng này được gọi là “strong forcing” (tác động cưỡng bức mạnh).
Trực giác ở đây là: khi tác động của <span class="math notranslate nohighlight">\(X\)</span> lên <span class="math notranslate nohighlight">\(Y\)</span> quá mạnh, <span class="math notranslate nohighlight">\(Y\)</span> sẽ có xu hướng “trông rất giống” <span class="math notranslate nohighlight">\(X\)</span>. Do đó, việc ánh xạ chéo (cross map) từ <span class="math notranslate nohighlight">\(M_x\)</span> sang <span class="math notranslate nohighlight">\(M_y\)</span> trở nên dễ dàng hơn, mặc dù về mặt nhân quả thì điều này không nên xảy ra. Kết quả là ta có thể bị đánh lừa và nghĩ rằng tồn tại quan hệ nhân quả hai chiều, trong khi thực tế thì không.</p></li>
<li><p>Vậy điều này hàm ý gì khi sử dụng CCM để suy luận quan hệ nhân quả?</p></li>
</ul>
</section>
<section id="ung-dung-trong-cac-he-thong-thuc-te">
<h2>Ứng dụng trong các hệ thống thực tế<a class="headerlink" href="#ung-dung-trong-cac-he-thong-thuc-te" title="Permalink to this heading">#</a></h2>
<p>Ở đây, chúng ta áp dụng CCM lên các hệ thống trong thế giới thực để suy luận mối quan hệ giữa các biến.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">make_plots</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">dt_name</span><span class="p">,</span> <span class="n">val1_name</span><span class="p">,</span> <span class="n">val2_name</span><span class="p">):</span>
    <span class="c1"># drop nulls</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">dt_name</span><span class="p">,</span> <span class="n">val1_name</span><span class="p">,</span> <span class="n">val2_name</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    
    <span class="c1"># plot</span>
    <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dt_name</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">val1_name</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">val1_name</span><span class="p">)</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
    <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dt_name</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">val2_name</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">val2_name</span><span class="p">)</span>    
<span class="c1">#     ax.figure.legend()        </span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">val1_name</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">val2_name</span><span class="si">}</span><span class="s2">, correlation coefficient: </span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="phim-cua-nicolas-cage-va-so-nguoi-chet-duoi-tai-my">
<h3>Phim của Nicolas Cage và số người chết đuối tại Mỹ<a class="headerlink" href="#phim-cua-nicolas-cage-va-so-nguoi-chet-duoi-tai-my" title="Permalink to this heading">#</a></h3>
<p>Chúng ta kiểm tra mức độ mà số người chết đuối tại Mỹ ảnh hưởng đến số lượng phim của Nicolas Cage trong từng năm và ngược lại. Liệu chúng ta có kỳ vọng hai đại lượng này có mối liên hệ nhân quả với nhau hay không?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/cage_drowning.csv&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1999</span><span class="p">,</span> <span class="mi">2010</span><span class="p">)</span>
<span class="n">make_plots</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;num.drowned&#39;</span><span class="p">,</span> <span class="s1">&#39;num.cage.films&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/01f244402752b307712953954baee355cdff3c39cc26299d504aaf18ca9eb2c4.png" src="../_images/01f244402752b307712953954baee355cdff3c39cc26299d504aaf18ca9eb2c4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize simple shadow manifolds Mx and My for different tau</span>
<span class="c1"># We visualize Cross-Mapping</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># we fix the seed when randomly choosing cross mapping points</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># time lag</span>
<span class="n">E</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># shadow manifold embedding dimensions</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># length of time period to consider</span>

<span class="n">Y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;num.cage.films&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;num.drowned&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Looking at &quot;convergence&quot;</span>
<span class="n">L_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">L</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># L values to test</span>
<span class="n">Xhat_My</span><span class="p">,</span> <span class="n">Yhat_Mx</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span> <span class="c1"># correlation list</span>
<span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">L_range</span><span class="p">:</span> 
    <span class="n">ccm_XY</span> <span class="o">=</span> <span class="n">ccm</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="c1"># define new ccm object # Testing for X -&gt; Y</span>
    <span class="n">ccm_YX</span> <span class="o">=</span> <span class="n">ccm</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="c1"># define new ccm object # Testing for Y -&gt; X    </span>
    <span class="n">Xhat_My</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ccm_XY</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> 
    <span class="n">Yhat_Mx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ccm_YX</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>    
    
<span class="c1"># plot convergence as L-&gt;inf. Convergence is necessary to conclude causality</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">L_range</span><span class="p">,</span> <span class="n">Xhat_My</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\hat</span><span class="si">{X}</span><span class="s1">(t)|M_y$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">L_range</span><span class="p">,</span> <span class="n">Yhat_Mx</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\hat</span><span class="si">{Y}</span><span class="s1">(t)|M_x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;correl&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>  

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;X-&gt;Y r&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Xhat_My</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;p value&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ccm_XY</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Y-&gt;X r&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Yhat_Mx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;p value&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ccm_YX</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X-&gt;Y r 0.21 p value 0.55
Y-&gt;X r -0.11 p value 0.77
</pre></div>
</div>
<img alt="../_images/daec5a30a21b81e5da66e32c9b2d138b1f7d21e47df4f6fb9b7f4218d137c7a4.png" src="../_images/daec5a30a21b81e5da66e32c9b2d138b1f7d21e47df4f6fb9b7f4218d137c7a4.png" />
</div>
</div>
<p><strong>Thảo luận</strong></p>
<p>Mặc dù trong khoảng thời gian lên đến 7, có vẻ như tồn tại sự hội tụ, thể hiện qua việc cải thiện hệ số tương quan của cross mapping, nhưng khi tiếp tục xét các khoảng thời gian dài hơn thì mức độ hội tụ lại giảm xuống. Do đó, chúng tôi kết luận rằng hai biến này không có mối liên hệ nhân quả.</p>
</section>
<section id="he-thong-dap">
<h3>Hệ thống đập<a class="headerlink" href="#he-thong-dap" title="Permalink to this heading">#</a></h3>
<p>Tiếp theo, chúng ta xem xét hai hệ thống đập tại Philippines: đập Angat và đập Ipo, cùng với lượng mưa và lưu lượng nước tưới tiêu (NIA).</p>
<section id="dap-angat-vs-luong-mua">
<h4>Đập Angat vs Lượng mưa<a class="headerlink" href="#dap-angat-vs-luong-mua" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Num Angat Dam Level vs NIA (what is NIA?)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/Angat_dataset.csv&#39;</span><span class="p">)</span>
<span class="n">make_plots</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="s1">&#39;Dam&#39;</span><span class="p">,</span> <span class="s1">&#39;Rain&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/fcba090ceb3c49c82d1d28cb15142ac9b9f5599526714facefedc3d1fb4e6ca6.png" src="../_images/fcba090ceb3c49c82d1d28cb15142ac9b9f5599526714facefedc3d1fb4e6ca6.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize simple shadow manifolds Mx and My for different tau</span>
<span class="c1"># We visualize Cross-Mapping</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># we fix the seed when randomly choosing cross mapping points</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># time lag</span>
<span class="n">E</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># shadow manifold embedding dimensions</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># length of time period to consider</span>

<span class="n">Y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Dam&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Rain&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Looking at &quot;convergence&quot;</span>
<span class="n">L_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">L</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="c1"># L values to test</span>
<span class="n">Xhat_My</span><span class="p">,</span> <span class="n">Yhat_Mx</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span> <span class="c1"># correlation list</span>
<span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">L_range</span><span class="p">:</span> 
    <span class="n">ccm_XY</span> <span class="o">=</span> <span class="n">ccm</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="c1"># define new ccm object # Testing for X -&gt; Y</span>
    <span class="n">ccm_YX</span> <span class="o">=</span> <span class="n">ccm</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="c1"># define new ccm object # Testing for Y -&gt; X    </span>
    <span class="n">Xhat_My</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ccm_XY</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> 
    <span class="n">Yhat_Mx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ccm_YX</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>    
    
<span class="c1"># plot convergence as L-&gt;inf. Convergence is necessary to conclude causality</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">L_range</span><span class="p">,</span> <span class="n">Xhat_My</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\hat</span><span class="si">{X}</span><span class="s1">(t)|M_y$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">L_range</span><span class="p">,</span> <span class="n">Yhat_Mx</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\hat</span><span class="si">{Y}</span><span class="s1">(t)|M_x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;correl&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>   

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;X-&gt;Y r&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Xhat_My</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;p value&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ccm_XY</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Y-&gt;X r&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Yhat_Mx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;p value&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ccm_YX</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X-&gt;Y r 0.25 p value 0.0
Y-&gt;X r 0.17 p value 0.0
</pre></div>
</div>
<img alt="../_images/5e75587128ddcfbeb7ba7bc206a6838743466c5603147698ef4d3f7f2fac7746.png" src="../_images/5e75587128ddcfbeb7ba7bc206a6838743466c5603147698ef4d3f7f2fac7746.png" />
</div>
</div>
<p><strong>Discussion</strong></p>
<p>Ảnh hưởng của lượng mưa lên mực nước đập cho thấy một mức độ hội tụ nhất định khi chúng ta tăng độ dài khoảng thời gian <span class="math notranslate nohighlight">\(L\)</span>. Tuy nhiên, sự hội tụ không rõ ràng đối với ảnh hưởng của mực nước đập lên lượng mưa.</p>
</section>
<section id="id1">
<h4>Đập Angat vs Lượng mưa<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Num Angat Dam Level vs NIA (what is NIA?)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/Angat_dataset.csv&#39;</span><span class="p">)</span>
<span class="n">make_plots</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="s1">&#39;Dam&#39;</span><span class="p">,</span> <span class="s1">&#39;NIA&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c374e7300addffef7ca5489cf216e2959cd74395e3326b07ef9a364e0bea61a8.png" src="../_images/c374e7300addffef7ca5489cf216e2959cd74395e3326b07ef9a364e0bea61a8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize simple shadow manifolds Mx and My for different tau</span>
<span class="c1"># We visualize Cross-Mapping</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># we fix the seed when randomly choosing cross mapping points</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># time lag</span>
<span class="n">E</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># shadow manifold embedding dimensions</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># length of time period to consider</span>

<span class="n">Y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Dam&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;NIA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Looking at &quot;convergence&quot;</span>
<span class="n">L_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">L</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="c1"># L values to test</span>
<span class="n">Xhat_My</span><span class="p">,</span> <span class="n">Yhat_Mx</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span> <span class="c1"># correlation list</span>
<span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">L_range</span><span class="p">:</span> 
    <span class="n">ccm_XY</span> <span class="o">=</span> <span class="n">ccm</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="c1"># define new ccm object # Testing for X -&gt; Y</span>
    <span class="n">ccm_YX</span> <span class="o">=</span> <span class="n">ccm</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="c1"># define new ccm object # Testing for Y -&gt; X    </span>
    <span class="n">Xhat_My</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ccm_XY</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> 
    <span class="n">Yhat_Mx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ccm_YX</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>    
    
<span class="c1"># plot convergence as L-&gt;inf. Convergence is necessary to conclude causality</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">L_range</span><span class="p">,</span> <span class="n">Xhat_My</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\hat</span><span class="si">{X}</span><span class="s1">(t)|M_y$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">L_range</span><span class="p">,</span> <span class="n">Yhat_Mx</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\hat</span><span class="si">{Y}</span><span class="s1">(t)|M_x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;correl&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span> 

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;X-&gt;Y r&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Xhat_My</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;p value&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ccm_XY</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Y-&gt;X r&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Yhat_Mx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;p value&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ccm_YX</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X-&gt;Y r 0.59 p value 0.0
Y-&gt;X r 0.65 p value 0.0
</pre></div>
</div>
<img alt="../_images/9b6db67d34df8e2fb0ff077e071750d81d077fae9561cc51da4816089cb14fe9.png" src="../_images/9b6db67d34df8e2fb0ff077e071750d81d077fae9561cc51da4816089cb14fe9.png" />
</div>
</div>
<p><strong>Thảo luận</strong></p>
<p>Sự hội tụ rõ ràng hơn đối với ảnh hưởng của lưu lượng nước tưới tiêu lên mực nước đập. Tuy nhiên, vẫn tồn tại sự hội tụ khá nhiễu đối với ảnh hưởng của mực nước đập lên lưu lượng nước tưới tiêu.</p>
</section>
<section id="dap-ipo-vs-luong-mua">
<h4>Đập Ipo vs Lượng mưa<a class="headerlink" href="#dap-ipo-vs-luong-mua" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Num Ipo Dam Level vs NIA (what is NIA?)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/Ipo_dataset.csv&#39;</span><span class="p">)</span>
<span class="n">make_plots</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="s1">&#39;Dam&#39;</span><span class="p">,</span> <span class="s1">&#39;Rain&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0aa7dd3e2c7952df058ade15ce22515fa621dcfd2fc2e1300cce07d311b0c8d2.png" src="../_images/0aa7dd3e2c7952df058ade15ce22515fa621dcfd2fc2e1300cce07d311b0c8d2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize simple shadow manifolds Mx and My for different tau</span>
<span class="c1"># We visualize Cross-Mapping</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># we fix the seed when randomly choosing cross mapping points</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># time lag</span>
<span class="n">E</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># shadow manifold embedding dimensions</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># length of time period to consider</span>

<span class="n">Y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Dam&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Rain&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Looking at &quot;convergence&quot;</span>
<span class="n">L_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">L</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="c1"># L values to test</span>
<span class="n">Xhat_My</span><span class="p">,</span> <span class="n">Yhat_Mx</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span> <span class="c1"># correlation list</span>
<span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">L_range</span><span class="p">:</span> 
    <span class="n">ccm_XY</span> <span class="o">=</span> <span class="n">ccm</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="c1"># define new ccm object # Testing for X -&gt; Y</span>
    <span class="n">ccm_YX</span> <span class="o">=</span> <span class="n">ccm</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="c1"># define new ccm object # Testing for Y -&gt; X    </span>
    <span class="n">Xhat_My</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ccm_XY</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> 
    <span class="n">Yhat_Mx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ccm_YX</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>    
    
<span class="c1"># plot convergence as L-&gt;inf. Convergence is necessary to conclude causality</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">L_range</span><span class="p">,</span> <span class="n">Xhat_My</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\hat</span><span class="si">{X}</span><span class="s1">(t)|M_y$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">L_range</span><span class="p">,</span> <span class="n">Yhat_Mx</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\hat</span><span class="si">{Y}</span><span class="s1">(t)|M_x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;correl&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span> 

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;X-&gt;Y r&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Xhat_My</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;p value&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ccm_XY</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Y-&gt;X r&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Yhat_Mx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;p value&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ccm_YX</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X-&gt;Y r 0.3 p value 0.0
Y-&gt;X r 0.05 p value 0.0
</pre></div>
</div>
<img alt="../_images/81a46830f137a51bcc3b3f1de4793bb094929767277f21e18e578411599f6e9f.png" src="../_images/81a46830f137a51bcc3b3f1de4793bb094929767277f21e18e578411599f6e9f.png" />
</div>
</div>
<p><strong>Thảo luận</strong></p>
<p>Sự hội tụ là rõ ràng đối với ảnh hưởng của lượng mưa lên mực nước đập. Trong khi đó, không có sự hội tụ đối với ảnh hưởng của mực nước đập lên lượng mưa.</p>
</section>
<section id="dap-ipo-vs-nia">
<h4>Đập Ipo vs NIA<a class="headerlink" href="#dap-ipo-vs-nia" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Num Ipo Dam Level vs NIA (what is NIA?)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/Ipo_dataset.csv&#39;</span><span class="p">)</span>
<span class="n">make_plots</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="s1">&#39;Dam&#39;</span><span class="p">,</span> <span class="s1">&#39;NIA&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f03c653b096ce87cec5ffaa4899a57e137617001d142b66dbfa748577a0ff350.png" src="../_images/f03c653b096ce87cec5ffaa4899a57e137617001d142b66dbfa748577a0ff350.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize simple shadow manifolds Mx and My for different tau</span>
<span class="c1"># We visualize Cross-Mapping</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># we fix the seed when randomly choosing cross mapping points</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># time lag</span>
<span class="n">E</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># shadow manifold embedding dimensions</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># length of time period to consider</span>

<span class="n">Y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Dam&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;NIA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Looking at &quot;convergence&quot;</span>
<span class="n">L_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">L</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="c1"># L values to test</span>
<span class="n">Xhat_My</span><span class="p">,</span> <span class="n">Yhat_Mx</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span> <span class="c1"># correlation list</span>
<span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">L_range</span><span class="p">:</span> 
    <span class="n">ccm_XY</span> <span class="o">=</span> <span class="n">ccm</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="c1"># define new ccm object # Testing for X -&gt; Y</span>
    <span class="n">ccm_YX</span> <span class="o">=</span> <span class="n">ccm</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="c1"># define new ccm object # Testing for Y -&gt; X    </span>
    <span class="n">Xhat_My</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ccm_XY</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> 
    <span class="n">Yhat_Mx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ccm_YX</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>    
    
<span class="c1"># plot convergence as L-&gt;inf. Convergence is necessary to conclude causality</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">L_range</span><span class="p">,</span> <span class="n">Xhat_My</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\hat</span><span class="si">{X}</span><span class="s1">(t)|M_y$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">L_range</span><span class="p">,</span> <span class="n">Yhat_Mx</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\hat</span><span class="si">{Y}</span><span class="s1">(t)|M_x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;correl&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span> 

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;X-&gt;Y r&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Xhat_My</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;p value&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ccm_XY</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Y-&gt;X r&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Yhat_Mx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;p value&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ccm_YX</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X-&gt;Y r 0.31 p value 0.0
Y-&gt;X r 0.21 p value 0.0
</pre></div>
</div>
<img alt="../_images/66543fc8ea0e906cf2236715227ed69be1d7b36eb29e08fe792ece1b89ab16b3.png" src="../_images/66543fc8ea0e906cf2236715227ed69be1d7b36eb29e08fe792ece1b89ab16b3.png" />
</div>
</div>
<p><strong>Thảo luận</strong></p>
<p>Sự hội tụ (convergence) thể hiện rõ ràng đối với tác động của lưu lượng nước tưới lên mực nước đập, nhưng không rõ ràng đối với tác động của mực nước đập lên lưu lượng nước tưới.</p>
</section>
<section id="dap-ipo-vs-dap-angat">
<h4>Đập Ipo vs Đập Angat<a class="headerlink" href="#dap-ipo-vs-dap-angat" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Num Ipo Dam Level vs Angat Dam Level</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/Ipo_dataset.csv&#39;</span><span class="p">)[[</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="s1">&#39;Dam&#39;</span><span class="p">]]</span>
<span class="n">df1</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Dam&#39;</span><span class="p">:</span><span class="s1">&#39;Ipo_Dam&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/Angat_dataset.csv&#39;</span><span class="p">)[[</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="s1">&#39;Dam&#39;</span><span class="p">]]</span>
<span class="n">df2</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Dam&#39;</span><span class="p">:</span><span class="s1">&#39;Angat_Dam&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">make_plots</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="s1">&#39;Ipo_Dam&#39;</span><span class="p">,</span> <span class="s1">&#39;Angat_Dam&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4da7fe10a25e8a5b7b50d7f4ae61506c82fb40c8b21a127d641dea9f113a2367.png" src="../_images/4da7fe10a25e8a5b7b50d7f4ae61506c82fb40c8b21a127d641dea9f113a2367.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize simple shadow manifolds Mx and My for different tau</span>
<span class="c1"># We visualize Cross-Mapping</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># we fix the seed when randomly choosing cross mapping points</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># time lag</span>
<span class="n">E</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># shadow manifold embedding dimensions</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># length of time period to consider</span>

<span class="n">Y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Ipo_Dam&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Angat_Dam&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Looking at &quot;convergence&quot;</span>
<span class="n">L_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">L</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="c1"># L values to test</span>
<span class="n">Xhat_My</span><span class="p">,</span> <span class="n">Yhat_Mx</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span> <span class="c1"># correlation list</span>
<span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">L_range</span><span class="p">:</span> 
    <span class="n">ccm_XY</span> <span class="o">=</span> <span class="n">ccm</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="c1"># define new ccm object # Testing for X -&gt; Y</span>
    <span class="n">ccm_YX</span> <span class="o">=</span> <span class="n">ccm</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="c1"># define new ccm object # Testing for Y -&gt; X    </span>
    <span class="n">Xhat_My</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ccm_XY</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> 
    <span class="n">Yhat_Mx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ccm_YX</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>    
    
<span class="c1"># plot convergence as L-&gt;inf. Convergence is necessary to conclude causality</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">L_range</span><span class="p">,</span> <span class="n">Xhat_My</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\hat</span><span class="si">{X}</span><span class="s1">(t)|M_y$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">L_range</span><span class="p">,</span> <span class="n">Yhat_Mx</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\hat</span><span class="si">{Y}</span><span class="s1">(t)|M_x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;correl&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>   

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;X-&gt;Y r&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Xhat_My</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;p value&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ccm_XY</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Y-&gt;X r&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Yhat_Mx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;p value&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ccm_YX</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X-&gt;Y r 0.33 p value 0.0
Y-&gt;X r 0.2 p value 0.0
</pre></div>
</div>
<img alt="../_images/f1425b3d301ccddd76fb0baea3521b605d14db695240a739d413bead2b9bd6f0.png" src="../_images/f1425b3d301ccddd76fb0baea3521b605d14db695240a739d413bead2b9bd6f0.png" />
</div>
</div>
<p><strong>Thảo luận</strong></p>
<p>Ảnh hưởng của mực nước đập Angat lên đập Ipo mạnh hơn so với chiều ngược lại. Đồng thời, cũng lưu ý rằng sự hội tụ không rõ ràng đối với ảnh hưởng của mực nước đập Ipo lên mực nước đập Angat.</p>
</section>
</section>
<section id="cac-moi-quan-he-nhan-qua-duoc-suy-ra-trong-he-thong-dap">
<h3>Các mối quan hệ nhân quả được suy ra trong hệ thống đập<a class="headerlink" href="#cac-moi-quan-he-nhan-qua-duoc-suy-ra-trong-he-thong-dap" title="Permalink to this heading">#</a></h3>
<p>Dựa trên các kết quả ở trên, chúng ta có thể suy ra một mạng lưới các mối quan hệ nhân quả.
Những mối quan hệ có sự hội tụ không rõ ràng được biểu diễn bằng đường nét đứt, trong khi những mối quan hệ có sự hội tụ rõ ràng được biểu diễn bằng đường liền.</p>
<a class="reference internal image-reference" href="../_images/dam_inferred_causality.png"><img alt="../_images/dam_inferred_causality.png" src="../_images/dam_inferred_causality.png" style="width: 400px;" /></a>
</section>
<section id="du-lieu-khi-hau-jena">
<h3>Dữ liệu khí hậu Jena<a class="headerlink" href="#du-lieu-khi-hau-jena" title="Permalink to this heading">#</a></h3>
<p>Tại đây, chúng ta xem xét một số dữ liệu khí hậu được thu thập từ Viện Max Planck về Địa hoá sinh học (Max Planck Institute for Biogeochemistry) tại Jena, Đức, trong giai đoạn từ năm 2009 đến năm 2016.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/jena_climate_2009_2016.csv&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">make_plots</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="s1">&#39;p (mbar)&#39;</span><span class="p">,</span> <span class="s1">&#39;T (degC)&#39;</span><span class="p">)</span> <span class="c1"># plot pressure vs Temperature</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/dbf7fdf4277b3283875ef81a538ea3386a99a90a19c3e5cfee6765b07b3911a6.png" src="../_images/dbf7fdf4277b3283875ef81a538ea3386a99a90a19c3e5cfee6765b07b3911a6.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># we fix the seed when randomly choosing cross mapping points</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># time lag</span>
<span class="n">E</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># shadow manifold embedding dimensions</span>
<span class="n">L</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># length of time period to consider</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p (mbar)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;T (degC)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Looking at &quot;convergence&quot;</span>
<span class="n">L_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">L</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span> <span class="c1"># L values to test</span>
<span class="n">Xhat_My</span><span class="p">,</span> <span class="n">Yhat_Mx</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span> <span class="c1"># correlation list</span>
<span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">L_range</span><span class="p">:</span> 
    <span class="n">ccm_XY</span> <span class="o">=</span> <span class="n">ccm</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="c1"># define new ccm object # Testing for X -&gt; Y</span>
    <span class="n">ccm_YX</span> <span class="o">=</span> <span class="n">ccm</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="c1"># define new ccm object # Testing for Y -&gt; X    </span>
    <span class="n">Xhat_My</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ccm_XY</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> 
    <span class="n">Yhat_Mx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ccm_YX</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>    
    
<span class="c1"># plot convergence as L-&gt;inf. Convergence is necessary to conclude causality</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">L_range</span><span class="p">,</span> <span class="n">Xhat_My</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\hat</span><span class="si">{X}</span><span class="s1">(t)|M_y$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">L_range</span><span class="p">,</span> <span class="n">Yhat_Mx</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\hat</span><span class="si">{Y}</span><span class="s1">(t)|M_x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;correl&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>    

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;X-&gt;Y r&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Xhat_My</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;p value&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ccm_XY</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Y-&gt;X r&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Yhat_Mx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;p value&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ccm_YX</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X-&gt;Y r 0.73 p value 0.0
Y-&gt;X r 0.52 p value 0.0
</pre></div>
</div>
<img alt="../_images/1714b598a9cc55e5b7c1a7a97d3802473124ded2378faead07089a58641574e7.png" src="../_images/1714b598a9cc55e5b7c1a7a97d3802473124ded2378faead07089a58641574e7.png" />
</div>
</div>
<p><strong>Thảo luận</strong>
Có vẻ như tồn tại mối quan hệ hai chiều (giả sử không có hiện tượng strong forcing) giữa áp suất và nhiệt độ, trong đó áp suất có ảnh hưởng mạnh hơn lên nhiệt độ.</p>
</section>
<section id="bien-doi-khi-hau">
<h3>Biến đổi khí hậu<a class="headerlink" href="#bien-doi-khi-hau" title="Permalink to this heading">#</a></h3>
<p>Tại đây, chúng ta xem xét dữ liệu khí hậu được lấy từ climate.nasa.gov.</p>
<section id="phat-thai-co2-nhiet-do-toan-cau-va-dien-tich-bang-bac-cuc-phi-sinh-thai-non-ecological">
<h4>Phát thải CO₂, nhiệt độ toàn cầu và diện tích băng Bắc Cực (phi sinh thái / non-ecological)<a class="headerlink" href="#phat-thai-co2-nhiet-do-toan-cau-va-dien-tich-bang-bac-cuc-phi-sinh-thai-non-ecological" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/co2_temp - combined.csv&#39;</span><span class="p">)</span>
<span class="n">make_plots</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;co2_avg&#39;</span><span class="p">,</span> <span class="s1">&#39;diff_temp&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b2690f6ada07ba2afe89541d62a3d23ec2eb620b3d4d96a3ac2f2005cf3f6db7.png" src="../_images/b2690f6ada07ba2afe89541d62a3d23ec2eb620b3d4d96a3ac2f2005cf3f6db7.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># we fix the seed when randomly choosing cross mapping points</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># time lag</span>
<span class="n">E</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># shadow manifold embedding dimensions</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># length of time period to consider</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;co2_avg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;diff_temp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Looking at &quot;convergence&quot;</span>
<span class="n">L_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">L</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># L values to test</span>
<span class="n">Xhat_My</span><span class="p">,</span> <span class="n">Yhat_Mx</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span> <span class="c1"># correlation list</span>
<span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">L_range</span><span class="p">:</span> 
    <span class="n">ccm_XY</span> <span class="o">=</span> <span class="n">ccm</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="c1"># define new ccm object # Testing for X -&gt; Y</span>
    <span class="n">ccm_YX</span> <span class="o">=</span> <span class="n">ccm</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="c1"># define new ccm object # Testing for Y -&gt; X    </span>
    <span class="n">Xhat_My</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ccm_XY</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> 
    <span class="n">Yhat_Mx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ccm_YX</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>    
    
<span class="c1"># plot convergence as L-&gt;inf. Convergence is necessary to conclude causality</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">L_range</span><span class="p">,</span> <span class="n">Xhat_My</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\hat</span><span class="si">{X}</span><span class="s1">(t)|M_y$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">L_range</span><span class="p">,</span> <span class="n">Yhat_Mx</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\hat</span><span class="si">{Y}</span><span class="s1">(t)|M_x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;correl&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>    

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;X-&gt;Y r&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Xhat_My</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;p value&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ccm_XY</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Y-&gt;X r&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Yhat_Mx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;p value&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ccm_YX</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X-&gt;Y r 0.96 p value 0.0
Y-&gt;X r 0.95 p value 0.0
</pre></div>
</div>
<img alt="../_images/66bdabd529a8a2aba680bcb68d33a83a61fded5f919a65531f9f2d191436089c.png" src="../_images/66bdabd529a8a2aba680bcb68d33a83a61fded5f919a65531f9f2d191436089c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">make_plots</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;co2_avg&#39;</span><span class="p">,</span> <span class="s1">&#39;arctic_ice_area&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0daf86c925e845e97e8ac2a8fdce09e234b8be76e80f7a4b4529ce9711596f57.png" src="../_images/0daf86c925e845e97e8ac2a8fdce09e234b8be76e80f7a4b4529ce9711596f57.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;co2_avg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;arctic_ice_area&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># we fix the seed when randomly choosing cross mapping points</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># time lag</span>
<span class="n">E</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># shadow manifold embedding dimensions</span>
<span class="n">L</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="c1"># length of time period to consider</span>

<span class="c1"># Looking at &quot;convergence&quot;</span>
<span class="n">L_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">L</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># L values to test</span>
<span class="n">Xhat_My</span><span class="p">,</span> <span class="n">Yhat_Mx</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span> <span class="c1"># correlation list</span>
<span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">L_range</span><span class="p">:</span> 
    <span class="n">ccm_XY</span> <span class="o">=</span> <span class="n">ccm</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="c1"># define new ccm object # Testing for X -&gt; Y</span>
    <span class="n">ccm_YX</span> <span class="o">=</span> <span class="n">ccm</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="c1"># define new ccm object # Testing for Y -&gt; X    </span>
    <span class="n">Xhat_My</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ccm_XY</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> 
    <span class="n">Yhat_Mx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ccm_YX</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>    
    
<span class="c1"># plot convergence as L-&gt;inf. Convergence is necessary to conclude causality</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">L_range</span><span class="p">,</span> <span class="n">Xhat_My</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\hat</span><span class="si">{X}</span><span class="s1">(t)|M_y$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">L_range</span><span class="p">,</span> <span class="n">Yhat_Mx</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\hat</span><span class="si">{Y}</span><span class="s1">(t)|M_x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;correl&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>   

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;X-&gt;Y r&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Xhat_My</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;p value&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ccm_XY</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Y-&gt;X r&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Yhat_Mx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;p value&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ccm_YX</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X-&gt;Y r 0.76 p value 0.0
Y-&gt;X r 0.8 p value 0.0
</pre></div>
</div>
<img alt="../_images/26310c3c4bc61dee5537656078a5d5db6b1fc1e6263b0541627ca27508563c88.png" src="../_images/26310c3c4bc61dee5537656078a5d5db6b1fc1e6263b0541627ca27508563c88.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">make_plots</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;diff_temp&#39;</span><span class="p">,</span> <span class="s1">&#39;arctic_ice_area&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d43b307e62ae9b687525b678797b81833d5244d1a0c7ee6c8fffd94b9e832f41.png" src="../_images/d43b307e62ae9b687525b678797b81833d5244d1a0c7ee6c8fffd94b9e832f41.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;diff_temp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;arctic_ice_area&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># we fix the seed when randomly choosing cross mapping points</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># time lag</span>
<span class="n">E</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># shadow manifold embedding dimensions</span>
<span class="n">L</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="c1"># length of time period to consider</span>

<span class="c1"># Looking at &quot;convergence&quot;</span>
<span class="n">L_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">L</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># L values to test</span>
<span class="n">Xhat_My</span><span class="p">,</span> <span class="n">Yhat_Mx</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span> <span class="c1"># correlation list</span>
<span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">L_range</span><span class="p">:</span> 
    <span class="n">ccm_XY</span> <span class="o">=</span> <span class="n">ccm</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="c1"># define new ccm object # Testing for X -&gt; Y</span>
    <span class="n">ccm_YX</span> <span class="o">=</span> <span class="n">ccm</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="c1"># define new ccm object # Testing for Y -&gt; X    </span>
    <span class="n">Xhat_My</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ccm_XY</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> 
    <span class="n">Yhat_Mx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ccm_YX</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>    
    
<span class="c1"># plot convergence as L-&gt;inf. Convergence is necessary to conclude causality</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">L_range</span><span class="p">,</span> <span class="n">Xhat_My</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\hat</span><span class="si">{X}</span><span class="s1">(t)|M_y$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">L_range</span><span class="p">,</span> <span class="n">Yhat_Mx</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\hat</span><span class="si">{Y}</span><span class="s1">(t)|M_x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;correl&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;X-&gt;Y r&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Xhat_My</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;p value&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ccm_XY</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Y-&gt;X r&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Yhat_Mx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;p value&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ccm_YX</span><span class="o">.</span><span class="n">causality</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X-&gt;Y r 0.58 p value 0.0
Y-&gt;X r 0.69 p value 0.0
</pre></div>
</div>
<img alt="../_images/c9f5a23f561d9ee505fd2621dc07ba968c6d46bf5ae8d1e8d5185e84aafe8f3d.png" src="../_images/c9f5a23f561d9ee505fd2621dc07ba968c6d46bf5ae8d1e8d5185e84aafe8f3d.png" />
</div>
</div>
<p><strong>Thảo luận</strong></p>
<ul class="simple">
<li><p>Chúng ta quan sát thấy sự hội tụ mạnh (strong convergence) đối với tất cả các biến ở trên.</p></li>
<li><p>Chúng ta diễn giải các biểu đồ trên như thế nào? Liệu chúng ta đã thỏa mãn các điều kiện của Convergent Cross Mapping (CCM) — bao gồm cross mapping và hội tụ (convergence) — để có thể kết luận rằng tồn tại quan hệ nhân quả giữa từng cặp biến hay chưa?</p></li>
<li><p>Khái niệm “strong forcing” (tác động cưỡng bức mạnh) liên quan như thế nào đến cách chúng ta diễn giải các kết quả này?</p></li>
</ul>
</section>
</section>
<section id="cac-moi-quan-he-nhan-qua-cua-he-thong-khi-hau-duoc-suy-luan">
<h3>Các mối quan hệ nhân quả của hệ thống khí hậu được suy luận<a class="headerlink" href="#cac-moi-quan-he-nhan-qua-cua-he-thong-khi-hau-duoc-suy-luan" title="Permalink to this heading">#</a></h3>
<a class="reference internal image-reference" href="../_images/climate_causality.png"><img alt="../_images/climate_causality.png" src="../_images/climate_causality.png" style="width: 400px;" /></a>
<p>Dựa trên các kết quả ở trên, chúng ta có thể suy ra một mạng lưới các mối quan hệ nhân quả. Có vẻ như tồn tại các vòng phản hồi mạnh giữa cả ba yếu tố trong hệ thống. Khi đối chiếu với các nghiên cứu trước đây về chủ đề này, chúng ta nhận thấy có nhiều công trình ủng hộ những tương tác tưởng chừng như không trực quan trong mạng lưới nhân quả được suy luận:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.pnas.org/content/113/3/514">Sự tiến hóa của mật độ và phân tầng hóa học ở Nam Đại Tây Dương trong giai đoạn tan băng gần đây</a></p></li>
<li><p><a class="reference external" href="https://www.sciencedaily.com/releases/2014/09/140922110424.htm">Băng biển Bắc Cực giúp loại bỏ CO₂ khỏi khí quyển, theo một nghiên cứu</a></p></li>
<li><p><a class="reference external" href="https://iopscience.iop.org/article/10.1088/0022-3727/45/44/445302">Carbon dioxide làm tăng tính dễ vỡ của các tinh thể băng</a></p></li>
<li><p><a class="reference external" href="https://www.nature.com/news/how-carbon-dioxide-melted-the-world-1.10393">Carbon dioxide đã làm tan chảy thế giới như thế nào</a></p></li>
</ul>
</section>
</section>
<section id="han-che">
<h2>Hạn chế<a class="headerlink" href="#han-che" title="Permalink to this heading">#</a></h2>
<p>Chúng ta đã chỉ ra rằng CCM có thể là một công cụ mạnh mẽ để định lượng mối quan hệ nhân quả giữa các biến chỉ dựa trên dữ liệu chuỗi thời gian. Tuy nhiên, CCM có một hạn chế cần được thừa nhận: khi tồn tại hiện tượng “strong forcing” (tác động cưỡng bức mạnh) giữa hai biến, thì cross mapping hội tụ theo cả hai chiều vẫn có thể xảy ra ngay cả khi quan hệ nhân quả thực tế chỉ tồn tại theo một chiều.
Do đó, chúng ta phải loại trừ khả năng strong forcing trước khi có thể kết luận rằng hai biến có quan hệ nhân quả hai chiều.</p>
</section>
<section id="tom-tat">
<h2>Tóm tắt<a class="headerlink" href="#tom-tat" title="Permalink to this heading">#</a></h2>
<p>Trong chương này, chúng ta đã thảo luận về lý thuyết và thuật toán đứng sau phương pháp Convergent Cross Mapping (CCM) nhằm suy luận quan hệ nhân quả giữa các biến dựa trên dữ liệu chuỗi thời gian. Sau đó, chúng ta đã áp dụng CCM cho cả dữ liệu mô phỏng và dữ liệu thực tế.</p>
<p>Trong chương tiếp theo, chúng ta sẽ thảo luận về các kỹ thuật tìm kiếm mẫu (patterns) trong dữ liệu chuỗi thời gian, bao gồm: tương quan chéo (cross correlation), biến đổi Fourier (Fourier transform) và biến đổi Wavelet (Wavelet transform).</p>
</section>
<section id="tai-lieu-tham-khao">
<h2>Tài liệu tham khảo<a class="headerlink" href="#tai-lieu-tham-khao" title="Permalink to this heading">#</a></h2>
<p><strong>Tài liệu chính</strong></p>
<ul class="simple">
<li><p><a class="reference external" href="https://science.sciencemag.org/content/338/6106/496">Sugihara, G. et al., 2012. Detecting Causality in Complex Ecosystems. Science, 338(6106), pp.496-500.</a></p></li>
<li><p><a class="reference external" href="https://science.sciencemag.org/content/suppl/2012/09/19/science.1227079.DC1">Sugihara, G. et al., 2012. Supplementary Materials. [online] Science.</a></p></li>
</ul>
<p><strong>Tài liệu bổ trợ</strong></p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.pnas.org/content/pnas/suppl/2016/10/26/1607747113.DCSupplemental/pnas.1607747113.sapp.pdf">SI: Step-by-step EDM Analysis. PNAS</a></p></li>
<li><p><a class="reference external" href="https://cran.microsoft.com/snapshot/2018-07-06/web/packages/rEDM/vignettes/rEDM-algorithms.pdf">Daon, Y., 2018. Simplex and S-map Algorithms. Comprehensive R Archive Network</a></p></li>
<li><p><a class="reference external" href="https://www.zora.uzh.ch/id/eprint/129395/1/Simplex_projection_walkthrough.pdf">Petchey, O., 2016. Simplex projection walkthrough. Zurich Open Repository Archive</a></p></li>
<li><p><a class="reference external" href="https://arxiv.org/pdf/1603.01155.pdf">Mønster, D. et al., 2016. Inferring causality from noisy time series data
A test of Convergent Cross-Mapping. arXiv</a></p></li>
<li><p><a class="reference external" href="https://web.iitd.ac.in/~sumeet/Sahil_Parul_btp_thesis.pdf">Sahil Loomba &amp; Parul Jain. 2016. Causal Computational Models for Gene Regulatory Networks</a></p></li>
<li><p><a class="reference external" href="http://www.scholarpedia.org/article/Attractor_reconstruction">Sauer, T., 2021. Attractor Reconstruction. Scholarpedia.org</a></p></li>
<li><p>Uzal, Lucas &amp; Grinblat, G &amp; Verdes, Pablo. (2011). Optimal reconstruction of dynamical systems: A noise amplification approach. Physical review. E, Statistical, nonlinear, and soft matter physics. 84. 016223. 10.1103/PhysRevE.84.016223.</p></li>
<li><p>Tsonis A.A., Deyle E.R., Ye H., Sugihara G. (2018) Convergent Cross Mapping: Theory and an Example. In: Tsonis A. (eds) Advances in Nonlinear Geosciences. Springer, Cham. https://doi.org/10.1007/978-3-319-58895-7_27</p></li>
</ul>
<p><strong>Bộ dữ liệu</strong></p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/myazdani/spurious-correlation-studies/tree/master/data">Nicolas Cage Movies &amp; Drownings Stats</a></p></li>
<li><p><a class="reference external" href="https://climate.nasa.gov/vital-signs/carbon-dioxide/">Climate data</a></p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./06_ConvergentCrossMappingandSugiharaCausality"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gioi-thieu">Giới thiệu</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#goi-causal-ccm">Gói causal-ccm</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tam-quan-trong-cua-viec-hieu-nhan-qua">Tầm quan trọng của việc hiểu Nhân quả</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#han-che-cua-nhan-qua-granger">Hạn chế của Nhân quả Granger</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ccm-giai-quyet-cac-han-che-cua-nhan-qua-granger">CCM giải quyết các hạn chế của Nhân quả Granger</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cac-khai-niem-lien-quan">Các khái niệm liên quan</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#he-dong-luc-xac-dinh-deterministic-dynamical-systems">Hệ động lực xác định (Deterministic Dynamical Systems)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bo-hut-attractors">Bộ hút (Attractors)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dinh-ly-nhung-takens-va-cac-da-tap-bong-shadow-manifolds">Định lý nhúng Takens và các đa tạp bóng (Shadow Manifolds)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tong-quan-ve-ccm">Tổng quan về CCM</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cross-mapping-anh-xa-cheo">Cross Mapping (Ánh xạ chéo)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hoi-tu-convergence">Hội tụ (Convergence)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#xac-dinh-he-thong-mau-cua-chung-ta">Xác định hệ thống mẫu của chúng ta</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ccm-algorithm">CCM Algorithm</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dinh-nghia-cac-ham-trong-ccm">Định nghĩa các hàm trong CCM</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cac-ham-dung-de-truc-quan-hoa">Các hàm dùng để trực quan hóa</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#applying-ccm-to-our-sample-systems">Applying CCM to our Sample Systems</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ccm-co-the-du-doan-quan-he-nhan-qua-trong-he-kiem-thu-cua-chung-ta-khong">CCM có thể dự đoán quan hệ nhân quả trong hệ kiểm thử của chúng ta không?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cach-cac-he-so-beta-anh-huong-den-quan-he-nhan-qua-duoc-the-hien-thong-qua-su-hoi-tu">Cách các hệ số Beta ảnh hưởng đến quan hệ nhân quả được thể hiện thông qua sự hội tụ</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dieu-gi-xay-ra-neu-he-duoc-ghep-noi-bat-doi-xung-tac-dong-chi-theo-mot-chieu">Điều gì xảy ra nếu hệ được ghép nối bất đối xứng (tác động chỉ theo một chiều)?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#anh-huong-cua-strong-forcing-tac-dong-cuong-buc-manh">Ảnh hưởng của “Strong Forcing” (tác động cưỡng bức mạnh)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ung-dung-trong-cac-he-thong-thuc-te">Ứng dụng trong các hệ thống thực tế</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phim-cua-nicolas-cage-va-so-nguoi-chet-duoi-tai-my">Phim của Nicolas Cage và số người chết đuối tại Mỹ</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#he-thong-dap">Hệ thống đập</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dap-angat-vs-luong-mua">Đập Angat vs Lượng mưa</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Đập Angat vs Lượng mưa</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dap-ipo-vs-luong-mua">Đập Ipo vs Lượng mưa</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dap-ipo-vs-nia">Đập Ipo vs NIA</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dap-ipo-vs-dap-angat">Đập Ipo vs Đập Angat</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cac-moi-quan-he-nhan-qua-duoc-suy-ra-trong-he-thong-dap">Các mối quan hệ nhân quả được suy ra trong hệ thống đập</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#du-lieu-khi-hau-jena">Dữ liệu khí hậu Jena</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bien-doi-khi-hau">Biến đổi khí hậu</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#phat-thai-co2-nhiet-do-toan-cau-va-dien-tich-bang-bac-cuc-phi-sinh-thai-non-ecological">Phát thải CO₂, nhiệt độ toàn cầu và diện tích băng Bắc Cực (phi sinh thái / non-ecological)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cac-moi-quan-he-nhan-qua-cua-he-thong-khi-hau-duoc-suy-luan">Các mối quan hệ nhân quả của hệ thống khí hậu được suy luận</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#han-che">Hạn chế</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tom-tat">Tóm tắt</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tai-lieu-tham-khao">Tài liệu tham khảo</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By By AI Department - TLU
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>